/*! For license information please see ketch.js.LICENSE.txt */
(()=>{var e={7007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}e.exports=r,e.exports.once=function(e,t){return new Promise((function(n,i){function o(n){e.removeListener(t,r),i(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}h(e,t,r,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&h(e,"error",t,{once:!0})}(e,o)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var o,r,s,u;if(a(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,u=d,console&&console.warn&&console.warn(u)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=d.bind(i);return o.listener=n,i.wrapFn=o,o}function p(e,t,n){var i=e._events;if(void 0===i)return[];var o=i[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):_(o,o.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function _(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function h(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(r){i.once&&e.removeEventListener(t,o),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return c(this)},r.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,r=this._events;if(void 0!==r)o=o&&void 0===r.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var u=c.length,d=_(c,u);for(n=0;n<u;++n)i(d[n],this,t)}return!0},r.prototype.addListener=function(e,t){return u(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return u(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,o,r,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return p(this,e,!0)},r.prototype.rawListeners=function(e){return p(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},r.prototype.listenerCount=f,r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9207:e=>{function t(e){var t=typeof e;return"object"===t?null===e?"null":function(e){if(Array.isArray(e))return!0;var t=e.length;return"number"==typeof t&&t>-1&&(!t||0 in e&&t-1 in e)}(e)?"array":e.constructor===Object?"pure-object":"object":t}e.exports=function e(n,i){if(n===i)return!0;if(n!=n&&i!=i)return!0;var o=t(n);if(o!==t(i))return!1;if("pure-object"===o){if(n===i)return!0;var r=Object.keys(n),s=Object.keys(i).length;if(r.length!==s)return!1;for(var a=0,c=r.length;a<c;a++){var u=r[a];if(!i.hasOwnProperty(r[a]))return!1;var d=n[u],l=i[u];if(d===n||l===i||d===i||l===n)return d===l;if(!e(d,l))return!1}return!0}if("array"===o){if(n.length!==i.length)return!1;for(var p=0;p<n.length;p++){var f=n[p],_=i[p];if(f===n||_===i||f===i||_===n)return f===_;if(!e(f,_))return!1}return!0}if("object"===o){if(n.valueOf!==Object.prototype.valueOf()&&i.valueOf!==Object.prototype.valueOf())return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString()&&i.toString!==Object.prototype.toString())return n.toString()===i.toString()}return!1}},7458:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=(0,n(5305).getLogger)("appDivs");t.default=function(e){var t,n,r;return i.__awaiter(this,void 0,void 0,(function*(){const i=yield e.getConfig();let s=[];o.debug("init",null===(t=i.options)||void 0===t?void 0:t.appDivs);const a=null===(r=null===(n=i.options)||void 0===n?void 0:n.appDivs)||void 0===r?void 0:r.trim();if(null==a?void 0:a.length){const t=a.split(",");e.on("willShowExperience",(()=>{o.debug("willShowExperience");for(const e of t){const t=document.getElementById(e);t&&(o.debug("obscuring",e),s.push({id:e,zIndex:t.style.zIndex}),t.style.zIndex="-1")}})),e.on("hideExperience",(()=>{o.debug("hideExperience");for(const e of s){const t=document.getElementById(e.id);t&&(o.debug("restoring",t.id),t.style.zIndex=e.zIndex)}s=[]}))}}))}},6865:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=(0,n(5305).getLogger)("dataLayer");function r(){return window.dataLayer=window.dataLayer||[]}t.default=function(e){return i.__awaiter(this,void 0,void 0,(function*(){e.on("geoip",(e=>{o.info("pushGeoIP",e);const t={event:"ketchGeoip",ip:e.ip,countryCode:e.countryCode,regionCode:e.regionCode};r().push(t)})),e.on("jurisdiction",(e=>{o.info("pushJurisdiction",e);const t={event:"ketchJurisdiction",jurisdictionCode:e};r().push(t)}))}))}},5307:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=i.__importDefault(n(7458)),r=i.__importDefault(n(6865)),s=n(5305),a=n(8163),c=(0,s.getLogger)("ketch");t.default=function(e){return i.__awaiter(this,void 0,void 0,(function*(){return c.info(`version ${a.version}`),Promise.all([(0,o.default)(e),(0,r.default)(e)]).then((()=>{}))}))}},2831:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var i=p(n(3518)),o=p(n(4948)),r=p(n(5073)),s=p(n(7186)),a=p(n(4808)),c=p(n(7775)),u=p(n(7037)),d=p(n(9910)),l=p(n(6792));function p(e){return e&&e.__esModule?e:{default:e}}},2311:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function i(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,o,r,s){return i((a=i(i(t,e),i(o,s)))<<(c=r)|a>>>32-c,n);var a,c}function r(e,t,n,i,r,s,a){return o(t&n|~t&i,e,t,r,s,a)}function s(e,t,n,i,r,s,a){return o(t&i|n&~i,e,t,r,s,a)}function a(e,t,n,i,r,s,a){return o(t^n^i,e,t,r,s,a)}function c(e,t,n,i,r,s,a){return o(n^(t|~i),e,t,r,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,i="0123456789abcdef";for(let o=0;o<n;o+=8){const n=e[o>>5]>>>o%32&255,r=parseInt(i.charAt(n>>>4&15)+i.charAt(15&n),16);t.push(r)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let o=1732584193,u=-271733879,d=-1732584194,l=271733878;for(let t=0;t<e.length;t+=16){const n=o,p=u,f=d,_=l;o=r(o,u,d,l,e[t],7,-680876936),l=r(l,o,u,d,e[t+1],12,-389564586),d=r(d,l,o,u,e[t+2],17,606105819),u=r(u,d,l,o,e[t+3],22,-1044525330),o=r(o,u,d,l,e[t+4],7,-176418897),l=r(l,o,u,d,e[t+5],12,1200080426),d=r(d,l,o,u,e[t+6],17,-1473231341),u=r(u,d,l,o,e[t+7],22,-45705983),o=r(o,u,d,l,e[t+8],7,1770035416),l=r(l,o,u,d,e[t+9],12,-1958414417),d=r(d,l,o,u,e[t+10],17,-42063),u=r(u,d,l,o,e[t+11],22,-1990404162),o=r(o,u,d,l,e[t+12],7,1804603682),l=r(l,o,u,d,e[t+13],12,-40341101),d=r(d,l,o,u,e[t+14],17,-1502002290),u=r(u,d,l,o,e[t+15],22,1236535329),o=s(o,u,d,l,e[t+1],5,-165796510),l=s(l,o,u,d,e[t+6],9,-1069501632),d=s(d,l,o,u,e[t+11],14,643717713),u=s(u,d,l,o,e[t],20,-373897302),o=s(o,u,d,l,e[t+5],5,-701558691),l=s(l,o,u,d,e[t+10],9,38016083),d=s(d,l,o,u,e[t+15],14,-660478335),u=s(u,d,l,o,e[t+4],20,-405537848),o=s(o,u,d,l,e[t+9],5,568446438),l=s(l,o,u,d,e[t+14],9,-1019803690),d=s(d,l,o,u,e[t+3],14,-187363961),u=s(u,d,l,o,e[t+8],20,1163531501),o=s(o,u,d,l,e[t+13],5,-1444681467),l=s(l,o,u,d,e[t+2],9,-51403784),d=s(d,l,o,u,e[t+7],14,1735328473),u=s(u,d,l,o,e[t+12],20,-1926607734),o=a(o,u,d,l,e[t+5],4,-378558),l=a(l,o,u,d,e[t+8],11,-2022574463),d=a(d,l,o,u,e[t+11],16,1839030562),u=a(u,d,l,o,e[t+14],23,-35309556),o=a(o,u,d,l,e[t+1],4,-1530992060),l=a(l,o,u,d,e[t+4],11,1272893353),d=a(d,l,o,u,e[t+7],16,-155497632),u=a(u,d,l,o,e[t+10],23,-1094730640),o=a(o,u,d,l,e[t+13],4,681279174),l=a(l,o,u,d,e[t],11,-358537222),d=a(d,l,o,u,e[t+3],16,-722521979),u=a(u,d,l,o,e[t+6],23,76029189),o=a(o,u,d,l,e[t+9],4,-640364487),l=a(l,o,u,d,e[t+12],11,-421815835),d=a(d,l,o,u,e[t+15],16,530742520),u=a(u,d,l,o,e[t+2],23,-995338651),o=c(o,u,d,l,e[t],6,-198630844),l=c(l,o,u,d,e[t+7],10,1126891415),d=c(d,l,o,u,e[t+14],15,-1416354905),u=c(u,d,l,o,e[t+5],21,-57434055),o=c(o,u,d,l,e[t+12],6,1700485571),l=c(l,o,u,d,e[t+3],10,-1894986606),d=c(d,l,o,u,e[t+10],15,-1051523),u=c(u,d,l,o,e[t+1],21,-2054922799),o=c(o,u,d,l,e[t+8],6,1873313359),l=c(l,o,u,d,e[t+15],10,-30611744),d=c(d,l,o,u,e[t+6],15,-1560198380),u=c(u,d,l,o,e[t+13],21,1309151649),o=c(o,u,d,l,e[t+4],6,-145523070),l=c(l,o,u,d,e[t+11],10,-1120210379),d=c(d,l,o,u,e[t+2],15,718787259),u=c(u,d,l,o,e[t+9],21,-343485551),o=i(o,n),u=i(u,p),d=i(d,f),l=i(l,_)}return[o,u,d,l]}(function(e){if(0===e.length)return[];const t=8*e.length,i=new Uint32Array(n(t));for(let n=0;n<t;n+=8)i[n>>5]|=(255&e[n/8])<<n%32;return i}(e),8*e.length))}},6140:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},4808:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},6792:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=n(7037))&&i.__esModule?i:{default:i};t.default=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},7656:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},2858:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)};const i=new Uint8Array(16)},9042:(e,t)=>{"use strict";function n(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:case 3:return t^n^i;case 2:return t&n^t&i^n&i}}function i(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,s=Math.ceil(r/16),a=new Array(s);for(let t=0;t<s;++t){const n=new Uint32Array(16);for(let i=0;i<16;++i)n[i]=e[64*t+4*i]<<24|e[64*t+4*i+1]<<16|e[64*t+4*i+2]<<8|e[64*t+4*i+3];a[t]=n}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<s;++e){const r=new Uint32Array(80);for(let t=0;t<16;++t)r[t]=a[e][t];for(let e=16;e<80;++e)r[e]=i(r[e-3]^r[e-8]^r[e-14]^r[e-16],1);let s=o[0],c=o[1],u=o[2],d=o[3],l=o[4];for(let e=0;e<80;++e){const o=Math.floor(e/20),a=i(s,5)+n(o,c,u,d)+l+t[o]+r[e]>>>0;l=d,d=u,u=i(c,30)>>>0,c=s,s=a}o[0]=o[0]+s>>>0,o[1]=o[1]+c>>>0,o[2]=o[2]+u>>>0,o[3]=o[3]+d>>>0,o[4]=o[4]+l>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}},9910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var i,o=(i=n(7037))&&i.__esModule?i:{default:i};const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));function s(e,t=0){return r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]}t.default=function(e,t=0){const n=s(e,t);if(!(0,o.default)(n))throw TypeError("Stringified UUID is invalid");return n}},3518:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=n(2858))&&i.__esModule?i:{default:i},r=n(9910);let s,a,c=0,u=0;t.default=function(e,t,n){let i=t&&n||0;const d=t||new Array(16);let l=(e=e||{}).node||s,p=void 0!==e.clockseq?e.clockseq:a;if(null==l||null==p){const t=e.random||(e.rng||o.default)();null==l&&(l=s=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==p&&(p=a=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),_=void 0!==e.nsecs?e.nsecs:u+1;const h=f-c+(_-u)/1e4;if(h<0&&void 0===e.clockseq&&(p=p+1&16383),(h<0||f>c)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,u=_,a=p,f+=122192928e5;const g=(1e4*(268435455&f)+_)%4294967296;d[i++]=g>>>24&255,d[i++]=g>>>16&255,d[i++]=g>>>8&255,d[i++]=255&g;const E=f/4294967296*1e4&268435455;d[i++]=E>>>8&255,d[i++]=255&E,d[i++]=E>>>24&15|16,d[i++]=E>>>16&255,d[i++]=p>>>8|128,d[i++]=255&p;for(let e=0;e<6;++e)d[i+e]=l[e];return t||(0,r.unsafeStringify)(d)}},4948:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(9025)),o=r(n(2311));function r(e){return e&&e.__esModule?e:{default:e}}var s=(0,i.default)("v3",48,o.default);t.default=s},9025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function i(e,i,s,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof i&&(i=(0,r.default)(i)),16!==(null===(c=i)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(i),u.set(e,i.length),u=n(u),u[6]=15&u[6]|t,u[8]=63&u[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=u[e];return s}return(0,o.unsafeStringify)(u)}try{i.name=e}catch(e){}return i.DNS=s,i.URL=a,i};var i,o=n(9910),r=(i=n(6792))&&i.__esModule?i:{default:i};const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},5073:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(n(6140)),o=s(n(2858)),r=n(9910);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(i.default.randomUUID&&!t&&!e)return i.default.randomUUID();const s=(e=e||{}).random||(e.rng||o.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return(0,r.unsafeStringify)(s)}},7186:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(9025)),o=r(n(9042));function r(e){return e&&e.__esModule?e:{default:e}}var s=(0,i.default)("v5",80,o.default);t.default=s},7037:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=n(7656))&&i.__esModule?i:{default:i};t.default=function(e){return"string"==typeof e&&o.default.test(e)}},7775:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=n(7037))&&i.__esModule?i:{default:i};t.default=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},8138:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Future=void 0;const i=n(1635),o=n(7007),r=i.__importDefault(n(9207));class s{constructor(e={}){this._options=e,this._value=void 0,this._error=void 0,this._emitter=new o.EventEmitter,e.maxListeners&&this.setMaxListeners(e.maxListeners),e.executor&&this.fulfill(e.executor),this._options.timeout?this._timeout=window.setTimeout((()=>{void 0===this._value&&void 0===this._error&&(this.error=new Error("timed out"))}),this._options.timeout):this._timeout=void 0}static resolve(e){return(new s).fulfill(e)}fulfill(e){return function(e){return"function"==typeof e}(e)?new Promise(e).then((e=>this.value=e)).catch((e=>this.error=e)):this.value=e,this}isFulfilled(){return void 0!==this._value}get fulfilled(){return void 0!==this._value?Promise.resolve(this._value):new Promise(((e,t)=>{this.once(s.FULFILLED,e),this.once(s.ERROR,t)}))}get value(){if(void 0!==this._error)throw this._error;if(void 0===this._value)throw new Error("future has not been resolved");return this._value}set value(e){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0),this._error=void 0,void 0!==this._value&&(0,r.default)(this._value,e)||(this._value=e,this._emitter.emit(s.FULFILLED,e),this._options.name&&this._options.emitter&&this._options.emitter.emit(this._options.name,e))}reset(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0);const e=this._value;this._value=void 0,this._error=void 0,this._emitter.emit(s.RESET,e),this._options.name&&this._options.emitter&&this._options.emitter.emit(this._options.name,void 0)}get error(){return this._error}set error(e){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0),this._error=e,this._value=void 0,void 0!==e&&this._emitter.emit(s.ERROR,e)}addListener(e,t){return this._emitter.addListener(e,t),this.trigger(e,t),this}on(e,t){return this.addListener(e,t)}once(e,t){return this.trigger(e,t)||this._emitter.once(e,t),this}removeListener(e,t){return this._emitter.removeListener(e,t),this}off(e,t){return this.removeListener(e,t)}removeAllListeners(e){return this._emitter.removeAllListeners(e),this}setMaxListeners(e){return this._emitter.setMaxListeners(e),this}then(e,t){return this.fulfilled.then(e,t)}catch(e){return this.fulfilled.catch(e)}trigger(e,t){return e===s.FULFILLED&&this.isFulfilled()?(t(this._value),!0):e===s.ERROR&&void 0!==this._error&&(t(this._error),!0)}}s.FULFILLED="fulfilled",s.RESET="reset",s.ERROR="error",t.Future=s,t.default=s},4925:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(835),r=n(2991);t.default=class{constructor(e=window,t=r.DEFAULT_TTL){this._window=e,this._ttl=t}getItem(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=(0,o.getCookie)(this._window,e);if(t)try{return JSON.parse(atob(t))}catch(e){return}}))}setItem(e,t){return i.__awaiter(this,void 0,void 0,(function*(){return!!(0,o.setCookie)(this._window,e,btoa(JSON.stringify(t)),this._ttl)&&this.getItem(e).then((e=>!!e))}))}removeItem(e){return i.__awaiter(this,void 0,void 0,(function*(){return(0,o.setCookie)(this._window,e,"",-86400),this.getItem(e).then((e=>!e))}))}}},9791:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetaCacher=t.WebStorageCacher=t.CookieCacher=t.getDefaultCacher=void 0;const i=n(1635),o=i.__importDefault(n(4925));t.CookieCacher=o.default;const r=i.__importDefault(n(2644));t.WebStorageCacher=r.default;const s=i.__importDefault(n(3842));t.MetaCacher=s.default;const a=n(2991);t.getDefaultCacher=function(e={}){var t,n;const i=null!==(t=e.window)&&void 0!==t?t:window,c=null!==(n=e.ttl)&&void 0!==n?n:a.DEFAULT_TTL;return new s.default(new o.default(i,c),new r.default(i.localStorage,c),new r.default(i.sessionStorage,c))}},3842:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);t.default=class{constructor(...e){this._cachers=e}getItem(e){return i.__awaiter(this,void 0,void 0,(function*(){for(const t of this._cachers){const n=yield t.getItem(e);if(n)return n}}))}setItem(e,t){return i.__awaiter(this,void 0,void 0,(function*(){for(const n of this._cachers)if(yield n.setItem(e,t))return!0;return!1}))}removeItem(e){return i.__awaiter(this,void 0,void 0,(function*(){for(const t of this._cachers)if(yield t.removeItem(e))return!0;return!1}))}}},2991:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TTL=void 0,t.DEFAULT_TTL=604800},2644:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(2991);t.default=class{constructor(e=window.localStorage,t=o.DEFAULT_TTL){this._storage=e,this._ttl=t}getItem(e){return i.__awaiter(this,void 0,void 0,(function*(){try{const n=function(e,t){const n=e.getItem(`${t}_metadata`);if(n)return JSON.parse(atob(n))}(this._storage,e);if(!(n&&(t=n,t.iat<=Math.floor(Date.now()/1e3))))return;if(function(e){return e.exp<Math.floor(Date.now()/1e3)}(n))return void(yield this.removeItem(e));const i=this._storage.getItem(e);return i?JSON.parse(atob(i)):void 0}catch(e){return}var t}))}setItem(e,t){return i.__awaiter(this,void 0,void 0,(function*(){try{!function(e,t,n){e.setItem(`${t}_metadata`,btoa(JSON.stringify(n)))}(this._storage,e,function(e){const t=Math.floor(Date.now()/1e3);return{iat:t,exp:t+e}}(this._ttl));const n=btoa(JSON.stringify(t));return this._storage.setItem(e,n),n===this._storage.getItem(e)}catch(e){return!1}}))}removeItem(e){return i.__awaiter(this,void 0,void 0,(function*(){try{return function(e,t){e.removeItem(t)}(this._storage,e),this._storage.removeItem(e),!this._storage.getItem(e)}catch(e){return!1}}))}}},835:(e,t)=>{"use strict";function n(e,t){return e.document.cookie.split("; ").reduce(((e,n)=>{const i=n.split("=");return i[0]===t?decodeURIComponent(i[1]):e}),"")}Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=void 0,t.getCookie=n,t.setCookie=function(e,t,i,o){const r=e.document.location.hostname.split("."),s=[`${t}=${encodeURIComponent(i)}`,"path=/","SameSite=None","Secure"];if(o){const e=new Date(Date.now()+1e3*o).toUTCString();s.push(`expires=${e}`)}const a=s.join("; ");for(let o=2;o<=r.length;o++)if(e.document.cookie=`${a}; domain=${r.slice(-1*o).join(".")}`,n(e,t)===i)return!0;return e.document.cookie=a,!!n(e,t)}},7520:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.host=t.Host=void 0;const i=n(1635),o=n(7007),r=n(6410),s=n(8251);class a{constructor(e){this._origin=new URL(e).origin,this._events=new o.EventEmitter,this._rpc=new Map,addEventListener(r.MessageEvent,(0,s.makeListener)(this._events,this._origin)),this.on(r.RpcCall,((e,t,...n)=>i.__awaiter(this,void 0,void 0,(function*(){const i=this._rpc.get(e);this.emit(`rpcResult:${t}`,i?yield i(...n):new Error(`unimplemented: ${e}`))}))))}rpc(e,t){this._rpc.set(e,t)}on(e,t){this._events.on(e,t)}emit(e,...t){return(window.parent||window.opener).postMessage({eventName:e,args:t},this._origin),!0}}let c;t.Host=a,t.host=()=>{if(!c){const e=document.querySelector('meta[name="trusted-origin"]'),t=null==e?void 0:e.content;if(!t)throw new Error('could not find <meta name="trusted-origin" content="?" /> element');c=new a(t)}return c}},5237:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proxy=t.Proxy=t.host=t.Host=void 0;const i=n(7520);Object.defineProperty(t,"host",{enumerable:!0,get:function(){return i.host}}),Object.defineProperty(t,"Host",{enumerable:!0,get:function(){return i.Host}});const o=n(5798);Object.defineProperty(t,"proxy",{enumerable:!0,get:function(){return o.proxy}}),Object.defineProperty(t,"Proxy",{enumerable:!0,get:function(){return o.Proxy}})},5798:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proxy=t.Proxy=void 0;const i=n(1635),o=n(7007),r=n(6410),s=n(8251);class a{constructor(){this._events=new o.EventEmitter}open(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=new URL(e);return this._origin=t.origin,addEventListener(r.MessageEvent,(0,s.makeListener)(this._events,this._origin),{}),new Promise((t=>{const n=document.createElement(r.IframeElement);n.style.border=r.None,n.style.width=r.ZeroPixels,n.style.height=r.ZeroPixels,n.setAttribute(r.SandboxAttribute,r.SandboxRequirements),n.addEventListener(r.LoadEvent,(()=>{this._hostWindow=n.contentWindow,t()}),{}),n.setAttribute(r.SrcAttribute,e),document.body.appendChild(n)}))}))}on(e,t){this._events.on(e,t)}emit(e,...t){if(!this._origin||!this._hostWindow)throw new Error("host has not been opened");return this._hostWindow.postMessage({eventName:e,args:t},this._origin),!0}invoke(e,...t){return i.__awaiter(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{const o=Math.random().toString(16).slice(2);this._events.once(`rpcResult:${o}`,(e=>{e instanceof Error?i(e):n(e)})),this.emit(r.RpcCall,...[e,o].concat(...t))}))}))}}t.Proxy=a,t.proxy=new a},6410:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IframeElement=t.ZeroPixels=t.None=t.SandboxRequirements=t.SandboxAttribute=t.SrcAttribute=t.RpcCall=t.LoadEvent=t.MessageEvent=void 0,t.MessageEvent="message",t.LoadEvent="load",t.RpcCall="rpcCall",t.SrcAttribute="src",t.SandboxAttribute="sandbox",t.SandboxRequirements="allow-scripts allow-same-origin",t.None="none",t.ZeroPixels="0px",t.IframeElement="iframe"},8251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeListener=void 0,t.makeListener=function(e,t){return n=>{if(n.origin!==t)return void console.warn(`dropping untrusted message from ${n.origin}`);const i=n.data;i.eventName&&i.args?e.emit(i.eventName,...i.args):console.warn(`dropping bad message from ${n.origin}`)}}},5250:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(5305),r=n(4999),s=i.__importDefault(n(6092)),a=i.__importDefault(n(192)),c=i.__importDefault(n(5834)),u=i.__importDefault(n(300)),d=i.__importDefault(n(7931)),l=i.__importDefault(n(3449)),p=n(5926),f=n(4835),_=n(7296);t.default=class{constructor(e){this._config=e,this._api=new r.KetchWebAPI((0,u.default)(this._config))}build(){var e,t,n,r;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,o.wrapLogger)(d.default,"build");if(i.info(this._config),!this._config||!this._config.organization)throw c.default.invalidConfigurationError;const a=l.default.get(s.default.EXPERIENCE_VERSION);if(a){let e="";if(this._config.scripts)for(let t=0;t<this._config.scripts.length;t+=1)this._config.scripts[t].includes("lanyard")&&(e=this._config.scripts[t]);let t=!1;if(e.includes("/v1/")&&"new"===a?(e=e.replace("/v1/","/v2/"),t=!0):e.includes("/v2/")&&"old"===a&&(e=e.replace("/v2/","/v1/"),t=!0),t){const t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.defer=!0,n.async=!0,n.src=e,t.appendChild(n)}}const f=this.formatLanguage(new URLSearchParams(window.location.search).get(s.default.LANGUAGE)||l.default.get(s.default.LANGUAGE)||(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("ketch_lang"))||(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem("ketch_lang"))||document.documentElement.lang||document.documentElement.getAttribute("xml:lang")||window.navigator.language||this._config.language||"en");if((null===(e=this._config.property)||void 0===e?void 0:e.code)&&(null===(t=this._config.environment)||void 0===t?void 0:t.code)&&(null===(n=this._config.jurisdiction)||void 0===n?void 0:n.code)&&this._config.language===f){i.debug("full configuration");const e=new p.Ketch(this._api,this._config);return yield e.setEnvironment(this._config.environment),yield e.setJurisdiction(this._config.jurisdiction.code),e}const h=yield this.buildEnvironment();let g,E=l.default.get(s.default.REGION);E||(g=yield this.buildGeoIP(),E=yield this.buildRegionInfo(g));const v=yield this.buildJurisdiction(E),y={organizationCode:(0,_.santizePaths)(this._config.organization.code),propertyCode:(0,_.santizePaths)((null===(r=this._config.property)||void 0===r?void 0:r.code)||""),environmentCode:(0,_.santizePaths)(h.code),hash:(0,_.santizePaths)(h.hash||""),languageCode:(0,_.santizePaths)(f),jurisdictionCode:(0,_.santizePaths)(v)};i.info("loadConfig",y);const b=yield this._api.getFullConfiguration(y);a&&b.services&&(b.services[s.default.API_SERVER]=(0,u.default)(this._config));const C=new p.Ketch(this._api,b);return yield C.setEnvironment(h),g&&(yield C.setGeoIP(g)),yield C.setRegionInfo(E),yield C.setJurisdiction(v),yield this.setupTelemetry(C,b,{region:E}),C}))}setupTelemetry(e,t,n){var o,r,a,c,u,l,p,_;return i.__awaiter(this,void 0,void 0,(function*(){if(!t.services||!t.services.telemetry||""===t.services.telemetry)return!1;const i=parseFloat((null===(o=t.options)||void 0===o?void 0:o.beaconPercentage)||"1");let h=Math.random()<i;if(!h)return!1;const g={organizationCode:null!==(r=t.organization.code)&&void 0!==r?r:"",propertyCode:null!==(c=null===(a=t.property)||void 0===a?void 0:a.code)&&void 0!==c?c:"",environmentCode:null!==(l=null===(u=t.environment)||void 0===u?void 0:u.code)&&void 0!==l?l:"",jurisdictionCode:null!==(_=null===(p=t.jurisdiction)||void 0===p?void 0:p.code)&&void 0!==_?_:"",purposes:{},identities:{}},E=yield(0,f.getCachedConsent)(g,this._config),v=!!(E.collectedAt&&E.collectedAt>0);return e.once(s.default.IDENTITIES_EVENT,(e=>{var i;const o=this.collectTelemetry(v,t,n,e,"once_identities");try{navigator.sendBeacon(`${null===(i=t.services)||void 0===i?void 0:i.telemetry}?${o.toString()}`)}catch(e){d.default.debug("telemetry error",e)}})),document.addEventListener("visibilitychange",(()=>{var i;if("hidden"===document.visibilityState&&h){h=!1;const o=e.getCurrentIdentities(),r=this.collectTelemetry(v,t,n,o,"visibility_hidden");try{navigator.sendBeacon(`${null===(i=t.services)||void 0===i?void 0:i.telemetry}?${r.toString()}`)}catch(e){d.default.debug("telemetry error",e)}}})),!0}))}collectTelemetry(e,t,n,i,o){var r,s,a,c;const u=new URLSearchParams,d=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;u.append("hasConsent",`${e}`),u.append("url",d),u.append("property",(null===(r=t.property)||void 0===r?void 0:r.code)||""),u.append("environment",(null===(s=t.environment)||void 0===s?void 0:s.code)||""),u.append("jurisdiction",(null===(a=t.jurisdiction)||void 0===a?void 0:a.code)||""),u.append("tenant",t.organization.code),u.append("dver",`${null===(c=t.deployment)||void 0===c?void 0:c.version}`),u.append("event_type",o),u.append("ids",window.btoa(JSON.stringify(i)));for(const[e,t]of Object.entries(n))u.append(e,t);return u}buildEnvironment(){return i.__awaiter(this,void 0,void 0,(function*(){const e=(0,o.wrapLogger)(d.default,"buildEnvironment");if(this._config.environment)return e.trace(this._config.environment),this._config.environment;if(!this._config.environments||0===this._config.environments.length)throw e.trace("no environments"),c.default.noEnvironmentError;const t=l.default.get(s.default.ENV);if(t){for(let n=0;n<this._config.environments.length;n+=1){const i=this._config.environments[n];if(i&&t&&i.code===t)return e.debug("found",i),i}throw e.trace("unknown environment"),c.default.noEnvironmentError}let n={};for(let e=0;e<this._config.environments.length;e+=1){const t=this._config.environments[e],i=atob(t.pattern||"");i&&new RegExp(i).test(window.document.location.href)&&(!n.pattern||i.length>atob(n.pattern).length)&&(n=t)}if(n.pattern)return e.debug("matched",n),n;for(let t=0;t<this._config.environments.length;t+=1){const n=this._config.environments[t];if(n.code===s.default.PRODUCTION)return e.debug(n.code,n),n}throw c.default.noEnvironmentError}))}formatLanguage(e){var t;const n=e.split("-")[0],i=null===(t=e.split("-")[1])||void 0===t?void 0:t.toUpperCase();return`${n}${i?`-${i}`:""}`}buildJurisdiction(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=(0,o.wrapLogger)(d.default,"buildJurisdiction");t.debug(this._config.jurisdiction);const n=l.default.get(s.default.JURISDICTION);if(n)return t.trace("override",n),n;const i=this._config.jurisdiction;if(!i)throw t.trace("no jurisdiction config"),c.default.noJurisdictionError;if(i.code)return t.trace(i.code),i.code;const r=document.documentElement.getAttribute("jurisdiction");if(r)return t.trace("document jurisdiction",r),r;const u=i.variable;if(u)for(const e of(0,a.default)()){const n=e[u];if(n)return t.trace("dataLayer jurisdiction",n),n}if(i.jurisdictions){const n=i.jurisdictions[e];if(n)return t.trace("region jurisdiction",n),n}if(i.defaultJurisdictionCode)return t.trace("default jurisdiction",i.defaultJurisdictionCode),i.defaultJurisdictionCode;throw c.default.noJurisdictionError}))}buildRegionInfo(e){var t;return i.__awaiter(this,void 0,void 0,(function*(){const n=(0,o.wrapLogger)(d.default,"buildRegionInfo");if(("US"===e.countryCode||"CA"===e.countryCode)&&e.regionCode){const t=`${e.countryCode}-${e.regionCode}`;return n.trace(t),t}const i=null!==(t=e.countryCode)&&void 0!==t?t:"US";return n.trace(i),i}))}buildGeoIP(){return i.__awaiter(this,void 0,void 0,(function*(){d.default.debug("buildGeoIP");const e=yield this._api.getLocation();if(!e||!e.location)throw c.default.unrecognizedLocationError;return e.location}))}}},436:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addToKetchLog=void 0,t.addToKetchLog=(e,t)=>{window.KetchLog||(window.KetchLog={}),window.KetchLog[e]||(window.KetchLog[e]=t)}},2433:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=i.__importDefault(n(7931)),r=n(5305),s=n(436),a=i.__importDefault(n(6092));t.default=class{constructor(e,t){this._blockedCookies=new Set,this.getGrantedPurposes=()=>i.__awaiter(this,void 0,void 0,(function*(){const e=(0,r.wrapLogger)(o.default,"CookieBlocker: getGrantedPurposes"),t=yield this._ketch.getConsent(),n=(null==t?void 0:t.purposes)||{};return e.debug("got consent purposes",n),new Set(Object.keys(n).filter((e=>!0===n[e])))})),this.execute=()=>i.__awaiter(this,void 0,void 0,(function*(){const e=(0,r.wrapLogger)(o.default,"CookieBlocker: execute"),t=document.cookie.split(";");if(!t.length)return e.debug("no browser cookies"),Array.from(this._blockedCookies);const n=window.location.hostname,i=yield this.getGrantedPurposes();return e.debug("granted purposes",i),Object.entries(this._config.blockedCookies||{}).forEach((([o,{purposeCodes:r,regex:s}])=>{if(r.some((e=>i.has(e))))return void e.debug(`not blocking ${o} as consent is granted for one of its purposes`);const a=new RegExp(s||"");t.forEach((t=>{const[i,r]=t.trim().split("=");!this._blockedCookies.has(i)&&(s&&a.test(i)||!s&&i===o)&&(document.cookie=`${i}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${n};`,this._blockedCookies.add(i),e.debug(`Deleted cookie: ${i} for domain: .${n}`))}))})),(0,s.addToKetchLog)("getBlockedCookies",(()=>{console.group(`Blocked Cookies (${this._blockedCookies.size}) ðŸª`),this._blockedCookies.size||console.log("No blocked cookies"),this._blockedCookies.forEach((e=>console.log(e))),console.groupEnd()})),Array.from(this._blockedCookies)})),this._ketch=e,this._config=t,this._ketch.on(a.default.CONSENT_EVENT,(()=>this.execute())),window.addEventListener("DOMContentLoaded",(()=>this.execute()))}}},8297:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=i.__importDefault(n(3004));class r extends o.default{constructor(e){super(e)}experienceClosed(e,t,n){return this._ketch.experienceClosed(e,t,n).then((()=>{}))}invokeRight(e){return this._ketch.invokeRight(e)}setProvisionalConsent(e){return this._ketch.setProvisionalConsent(e)}getSubscriptions(){return this._ketch.getSubscriptions()}setSubscriptions(e,t){return this._ketch.setSubscriptions(e,t)}getSubscriptionConfiguration(){return this._ketch.getSubscriptionConfiguration()}getIsExperienceDisplayed(){return this._ketch.getIsExperienceDisplayed()}willChangeExperience(e){return this._ketch.willChangeExperience(e).then((()=>{}))}hasChangedExperience(e){return this._ketch.hasChangedExperience(e).then((()=>{}))}hasShownExperience(){return this._ketch.hasShownExperience().then((()=>{}))}getConsent(e){return i.__awaiter(this,void 0,void 0,(function*(){if(e){const e=yield this.getIdentities();return yield this._ketch.fetchProtocols(e)}return this._ketch.getConsent()}))}registerUserAttributeProvider(e,t){return this._ketch.registerUserAttributeProvider(e,t)}}t.default=r},5926:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ketch=void 0;const i=n(1635),o=n(7007),r=i.__importDefault(n(8138)),s=n(8509),a=i.__importDefault(n(9220)),c=i.__importDefault(n(9207)),u=n(5305),d=n(5237),l=i.__importDefault(n(7262)),p=i.__importDefault(n(3044)),f=i.__importDefault(n(7931)),_=i.__importDefault(n(5834)),h=i.__importDefault(n(3449)),g=n(4835),E=i.__importStar(n(6092)),v=i.__importDefault(n(8297)),y=n(6122),b=n(7893),C=n(2186),T=n(838);class m extends o.EventEmitter{constructor(e,t){var n,i,o,c,u,d,l,p,f,_,g,v,y;super();const C=parseInt(null!==(i=null===(n=t.options)||void 0===n?void 0:n.maxListeners)&&void 0!==i?i:"20");this._api=e,this._config=t,this._consent=new r.default({name:E.default.CONSENT_EVENT,emitter:this,maxListeners:C}),this._protocols=new r.default({name:E.default.PROTOCOLS_EVENT,emitter:this,maxListeners:C}),this._environment=new r.default({name:E.default.ENVIRONMENT_EVENT,emitter:this,maxListeners:C}),this._geoip=new r.default({name:E.default.GEOIP_EVENT,emitter:this,maxListeners:C}),this._handleKeyboardEvent=new r.default({name:E.default.HANDLE_KEYBOARD_EVENT,emitter:this,maxListeners:C}),this._identities=new r.default({name:E.default.IDENTITIES_EVENT,emitter:this,maxListeners:C}),this._identitiesCurrent={},this._userAttributes=new r.default({name:E.default.USER_ATTRIBUTES_EVENT,emitter:this,maxListeners:C}),this._jurisdiction=new r.default({name:E.default.JURISDICTION_EVENT,emitter:this,maxListeners:C}),this._regionInfo=new r.default({name:E.default.REGION_INFO_EVENT,emitter:this,maxListeners:C}),this._returnKeyboardControl=new r.default({name:E.default.RETURN_KEYBOARD_CONTROL,emitter:this,maxListeners:C}),this._subscriptionConfig=new r.default({name:E.default.SUBSCRIPTIONS_EVENT,emitter:this,maxListeners:C}),this._subscriptions=new r.default({name:E.default.SUBSCRIPTION_CONFIG_EVENT,emitter:this,maxListeners:C}),this._hideExperienceReason=new r.default({name:E.default.HIDE_EXPERIENCE_REASON_EVENT,emitter:this,maxListeners:C}),this._isExperienceDisplayed=!1,this._hasExperienceBeenDisplayed=!1,this._isExperienceDisabled=(null===(o=this._config.deployment)||void 0===o?void 0:o.isOrchestrationOnly)||(null===(c=this._config)||void 0===c?void 0:c.isConfigPaused)||!1,this._hasProxyLoaded=!1,this._provisionalConsent=void 0,this._identityWatcher=new a.default(window,{interval:parseInt(null!==(d=null===(u=t.options)||void 0===u?void 0:u.watcherInterval)&&void 0!==d?d:"2000"),timeout:parseInt(null!==(p=null===(l=t.options)||void 0===l?void 0:l.watcherTimeout)&&void 0!==p?p:"10000")}),this._identityWatcher.on(E.default.IDENTITY_EVENT,this.setIdentities.bind(this)),this._userAttributeWatcher=new a.default(window,{interval:parseInt(null!==(_=null===(f=t.options)||void 0===f?void 0:f.watcherInterval)&&void 0!==_?_:"2000"),timeout:parseInt(null!==(v=null===(g=t.options)||void 0===g?void 0:g.watcherTimeout)&&void 0!==v?v:"10000")}),this._userAttributeWatcher.on(E.default.USER_ATTRIBUTE_EVENT,this.setUserAttributes.bind(this)),this.setMaxListeners(C),this._profileManager=new b.ProfileManager(this),this._needsConsent=new r.default({name:E.default.NEEDS_CONSENT_EVENT,emitter:this,maxListeners:C}),this._areRulesEnabled=!((null===(y=this._config.deployment)||void 0===y?void 0:y.featureVersion)!==s.DeploymentVersion.V2&&"1"!==h.default.get(E.default.EXPERIENCE_RULES_VERSION)||!this._config.rules)}set needsConsent(e){this._needsConsent.value=e}get hideExperienceReason(){return this._hideExperienceReason}registerPlugin(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n=new v.default(this),i=t||(yield this.getConfig());return e instanceof Function?e(n,i):(void 0!==e.willShowExperience&&this.on(E.default.WILL_SHOW_EXPERIENCE_EVENT,(t=>{void 0!==e.willShowExperience&&e.willShowExperience(n,this._config,t)})),void 0!==e.showConsentExperience&&this.on(E.default.SHOW_CONSENT_EXPERIENCE_EVENT,((t,i)=>{void 0!==e.showConsentExperience&&e.showConsentExperience(n,this._config,t,i)})),void 0!==e.showPreferenceExperience&&this.on(E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,((t,i)=>{void 0!==e.showPreferenceExperience&&e.showPreferenceExperience(n,this._config,t,i)})),void 0!==e.consentChanged&&this.on(E.default.CONSENT_EVENT,(t=>{void 0!==e.consentChanged&&e.consentChanged(n,this._config,t)})),void 0!==e.environmentLoaded&&this.on(E.default.ENVIRONMENT_EVENT,(t=>{void 0!==e.environmentLoaded&&e.environmentLoaded(n,this._config,t)})),void 0!==e.experienceHidden&&this.on(E.default.HIDE_EXPERIENCE_EVENT,(t=>{void 0!==e.experienceHidden&&e.experienceHidden(n,this._config,t)})),void 0!==e.geoIPLoaded&&this.on(E.default.GEOIP_EVENT,(t=>{void 0!==e.geoIPLoaded&&e.geoIPLoaded(n,this._config,t)})),void 0!==e.identitiesLoaded&&this.on(E.default.IDENTITIES_EVENT,(t=>{void 0!==e.identitiesLoaded&&e.identitiesLoaded(n,this._config,t)})),void 0!==e.jurisdictionLoaded&&this.on(E.default.JURISDICTION_EVENT,(t=>{void 0!==e.jurisdictionLoaded&&e.jurisdictionLoaded(n,this._config,t)})),void 0!==e.regionInfoLoaded&&this.on(E.default.REGION_INFO_EVENT,(t=>{void 0!==e.regionInfoLoaded&&e.regionInfoLoaded(n,this._config,t)})),void 0!==e.rightInvoked&&this.on(E.default.RIGHT_INVOKED_EVENT,(t=>{void 0!==e.rightInvoked&&e.rightInvoked(n,this._config,t)})),void 0!==e.init?e.init(n,i):Promise.resolve())}))}registerIdentityProvider(e,t){return i.__awaiter(this,void 0,void 0,(function*(){this._identityWatcher.add(e,t)}))}registerUserAttributeProvider(e,t){return i.__awaiter(this,void 0,void 0,(function*(){this._userAttributeWatcher.add(e,t)}))}registerStorageProvider(e,t){return i.__awaiter(this,void 0,void 0,(function*(){}))}registerExperienceServer(e){return i.__awaiter(this,void 0,void 0,(function*(){}))}getConfig(){return i.__awaiter(this,void 0,void 0,(function*(){return this._config}))}getFullConfig(){return i.__awaiter(this,void 0,void 0,(function*(){return this._config}))}selectExperience(e){var t,n;const i=(0,u.wrapLogger)(f.default,"selectExperience");if(this._hasExperienceBeenDisplayed)return void i.debug(E.default.NONE);const o=h.default.get(E.default.SHOW);if(o===E.default.PREFERENCES)return i.debug(s.ExperienceType.Preference),s.ExperienceType.Preference;if(o===E.default.NONE)return void i.debug(E.default.NONE);if(h.default.has(E.default.SHOW))return i.debug(s.ExperienceType.Consent),s.ExperienceType.Consent;if(this._areRulesEnabled)return void i.debug("no override set and rules are enabled, no experience will be shown");const r=Object.keys((null===(t=this._config.experiences)||void 0===t?void 0:t.autoInitiated)||{}).length>0||Object.keys((null===(n=this._config.experiences)||void 0===n?void 0:n.consent)||{}).length>0;if(i.debug("hasAutoInitiatedExperience",r),r&&this._config.purposes)for(const t of this._config.purposes)if(void 0===e.purposes[t.code])return i.debug(s.ExperienceType.Consent),s.ExperienceType.Consent;i.debug(E.default.NONE)}willShowExperience(e){var t,n;f.default.debug("willShowExperience",e),this.emit(E.default.WILL_SHOW_EXPERIENCE_EVENT,e);const i=null===(n=null===(t=this._config.experiences)||void 0===t?void 0:t.autoInitiated)||void 0===n?void 0:n.layout;i&&(e!==s.ExperienceType.Consent||i.banner||i.modal)&&(e!==s.ExperienceType.Preference||i.preference)&&(this._isExperienceDisplayed=!0)}experienceClosed(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){if(f.default.debug("experienceClosed",e),this._isExperienceDisplayed=!1,this._hasExperienceBeenDisplayed=!0,e!==s.ExperienceClosedReason.CLOSE_WITHOUT_SETTING_CONSENT)if(t&&e===s.ExperienceClosedReason.SET_CONSENT)yield this.setConsent(t,n||s.ConsentSource.Unknown,!0);else if(e!==s.ExperienceClosedReason.SET_CONSENT){n===s.ConsentSource.Unknown&&(n=s.ConsentSource.LegalBasisDefault);const e=yield this.retrieveConsent();if(this._config.purposes)for(const t of this._config.purposes)void 0===e.purposes[t.code]&&t.requiresOptIn&&(e.purposes[t.code]=!1);yield this.setConsent(e,n||s.ConsentSource.Unknown,!1)}return setTimeout((()=>{this.fireExperienceClosedEvents(e)}),0),this.retrieveConsent()}))}willChangeExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("willChangeExperience",e),this.emit(E.default.WILL_CHANGE_EXPERIENCE_EVENT,e)}))}hasChangedExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("hasChangedExperience",e),this.emit(E.default.HAS_CHANGED_EXPERIENCE_EVENT,e)}))}hasShownExperience(){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("hasShownExperience"),this.emit(E.default.HAS_SHOWN_EXPERIENCE_EVENT)}))}showConsentExperience(e){var t;return i.__awaiter(this,void 0,void 0,(function*(){return this._areRulesEnabled?(this.setProfile(b.ProfileSection.CONSENT_NEEDS_CONSENT,!0),(0,y.evaluateRules)(s.RuleTrigger.ON_LOAD,(null===(t=this._config.rules)||void 0===t?void 0:t[s.RuleTrigger.ON_LOAD])||[],this,e,"showConsent"),{}):this._showConsentExperience(e)}))}_showConsentExperience(e,t,n){var o;return i.__awaiter(this,void 0,void 0,(function*(){if(this._isExperienceDisabled)return{};const i=(0,u.wrapLogger)(f.default,"showConsentExperience");if(i.debug(e),this.getIsExperienceDisplayed())return i.debug("exiting showConsentExperience because an experience is already displayed"),{};const r=null===(o=this._config.experiences)||void 0===o?void 0:o.autoInitiated;if(r&&!Object.keys(r).length)return{};const s=yield this.retrieveConsent();return this._areRulesEnabled?(this.renderExperience(t,e,n),s):(this.listenerCount(E.default.SHOW_CONSENT_EXPERIENCE_EVENT)>0?this.showConsentExperienceTrigger(s,e):this.on("addedListener",(t=>{t===E.default.SHOW_CONSENT_EXPERIENCE_EVENT&&this.showConsentExperienceTrigger(s,e)})),s)}))}showConsentExperienceTrigger(e,t){this.triggerExperience(s.ExperienceType.Consent,E.default.SHOW_CONSENT_EXPERIENCE_EVENT,e||{},t)}updatePreferenceParams(e){var t,n;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"getPreferenceParams");let o;e=null!=e?e:{};let r=!0;try{o=yield this.getConsent()}catch(e){if(e!==_.default.noPurposesError)throw e;i.debug("No purposes detected, experience will not display consents tab"),o=E.EMPTY_CONSENT,r=!1}const a=h.default.get(E.default.PREFERENCES_TAB);a&&(0,s.isTab)(a)&&(e.tab=a,i.info("tab",a));const c=null===(n=null===(t=h.default.get(E.default.PREFERENCES_TABS))||void 0===t?void 0:t.split(","))||void 0===n?void 0:n.filter((e=>e&&(0,s.isTab)(e)));(null==c?void 0:c.length)&&(e.showOverviewTab=c.includes(s.Tab.Overview),e.showConsentsTab=r&&c.includes(s.Tab.Consents),e.showSubscriptionsTab=c.includes(s.Tab.Subscriptions),e.showRightsTab=c.includes(s.Tab.Rights),e.tab=c.includes(e.tab||"")?e.tab:c[0]);try{const t=yield this.getSubscriptionConfiguration();if(void 0!==t){if(void 0===e.showSubscriptionsTab&&(e.showSubscriptionsTab=!0),void 0!==t.topics&&0!==t.topics.length&&0!==Object.keys(t.identities).length||(e.showSubscriptionsTab=!1,i.trace("not showing subscriptions because invalid subscription config")),e.showSubscriptionsTab){let n=!1;const o=yield this.getIdentities();for(const e of Object.keys(t.identities))if(o[e]){n=!0;break}n||(i.trace("not showing subscriptions because no auth identities"),e.showSubscriptionsTab=!1)}}else i.trace("invalid subscription config"),e.showSubscriptionsTab=!1}catch(t){i.trace("invalid subscription config"),e.showSubscriptionsTab=!1}return e.showSubscriptionsTab||e.tab!==s.Tab.Subscriptions||(e.tab=void 0),[o,e]}))}showPreferenceExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){return this._areRulesEnabled?(yield this.trigger(void 0,e,"showPreference"),{}):this._showPreferenceExperience(e)}))}_showPreferenceExperience(e){var t,n,o,r,s,a;return i.__awaiter(this,void 0,void 0,(function*(){if(this._isExperienceDisabled)return{};const i=(0,u.wrapLogger)(f.default,"showPreferenceExperience");i.debug(e);const[c,d]=yield this.updatePreferenceParams(e),l=e=>!e||0===Object.keys(e).length,p=this._config.experiences,_=null==p?void 0:p.userInitiated;return l(null===(n=null===(t=this._config)||void 0===t?void 0:t.experiences)||void 0===n?void 0:n.preference)&&l(null===(o=null==p?void 0:p.content)||void 0===o?void 0:o.preference)&&l(null===(r=null==p?void 0:p.layout)||void 0===r?void 0:r.preference)&&l(null===(s=null==_?void 0:_.content)||void 0===s?void 0:s.preference)&&l(null===(a=null==_?void 0:_.layout)||void 0===a?void 0:a.preference)?(i.debug("no preference experience configured, no experience will be shown"),c):(this.listenerCount(E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT)>0?this.showPreferenceExperienceTrigger(d,c):this.on("addedListener",(e=>{e===E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT&&this.showPreferenceExperienceTrigger(d,c)})),c)}))}showPreferenceExperienceTrigger(e,t){this.triggerExperience(s.ExperienceType.Preference,E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,t||{},e)}showProgressiveExperience(e){return f.default.debug("showProgressiveExperience",e),this.emit(E.default.SHOW_PROGRESSIVE_EXPERIENCE_EVENT,e),Promise.resolve()}showConsentGate(e){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("showConsentGate",e),this.emit(E.default.SHOW_CONSENT_GATE_EXPERIENCE_EVENT,e),Promise.resolve()}))}showExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){return this._areRulesEnabled?(null==e?void 0:e.useAutoInitiated)?void(yield this.showConsentExperience()):yield this.trigger(void 0,e,"showExperience"):this._showExperience(e)}))}_showExperience(e){var t,n,o,r;return i.__awaiter(this,void 0,void 0,(function*(){if(this._isExperienceDisabled)return;const i=(0,u.wrapLogger)(f.default,"showExperience");i.debug(e);const a=null===(t=(yield this.getFullConfig()).experiences)||void 0===t?void 0:t.userInitiated;if((null==e?void 0:e.useAutoInitiated)||"preference"!==(null===(n=null==a?void 0:a.content)||void 0===n?void 0:n.display)){const t=yield this.getConsent();this.showExperienceTrigger(t,s.ExperienceType.Consent,e)}else{const[t,n]=yield this.updatePreferenceParams(null==e?void 0:e.preferenceOptions),c=e=>!e||0===Object.keys(e).length;if(c(null===(o=null==a?void 0:a.content)||void 0===o?void 0:o.preference)&&c(null===(r=null==a?void 0:a.layout)||void 0===r?void 0:r.preference))return void i.debug("no preference experience configured, no experience will be shown");this.showExperienceTrigger(t,s.ExperienceType.Preference,Object.assign(Object.assign({},e),{preferenceOptions:n}))}return Promise.resolve()}))}showExperienceTrigger(e,t,n){this.triggerExperience(t,E.default.SHOW_EXPERIENCE_EVENT,e,n)}renderExperience(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){if(this._isExperienceDisabled)return;(0,u.wrapLogger)(f.default,"renderExperience").debug({experienceType:e,params:t,displayOptions:n});const i=yield this.retrieveConsent();return this.renderExperienceTrigger(i,e,t,n),Promise.resolve()}))}renderExperienceTrigger(e,t,n,i){const o={experienceType:t,params:n,options:i};this.triggerExperience(t,E.default.RENDER_EXPERIENCE_EVENT,e,o)}triggerExperience(e,t,n,i){(0,u.wrapLogger)(f.default,`trigger${e}Experience`).debug(i),this.listenerCount(t)>0?(this.willShowExperience(e),this.emit(t,n,i)):this.on("addedListener",(o=>{o===t&&(this.willShowExperience(e),this.emit(t,n,i))}))}trigger(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=this._config.rules;if(e){const o=`${s.RuleTrigger.ON_FUNCTION}|${e}`;yield(0,y.evaluateRules)(o,(null==i?void 0:i[o])||[],this,t,n)}else yield(0,y.evaluateRules)(s.RuleTrigger.ON_FUNCTION,(null==i?void 0:i[s.RuleTrigger.ON_FUNCTION])||[],this,t,n)}))}onShowConsentExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("onShowConsentExperience"),this.removeAllListeners(E.default.SHOW_CONSENT_EXPERIENCE_EVENT),this.on(E.default.SHOW_CONSENT_EXPERIENCE_EVENT,e)}))}onShowPreferenceExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("onShowPreferenceExperience"),this.removeAllListeners(E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT),this.on(E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,e)}))}hasConsent(){return this._consent.isFulfilled()}setConsent(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"setConsent");if(i.debug(e),!e||(0,p.default)(e))return i.trace("reset"),this._consent.reset(),{};let o=!1;if(this.hasConsent()){i.trace("has consent");const t=this._consent.value;o=(0,c.default)(t.purposes,e.purposes);for(const n in t.purposes)Object.prototype.hasOwnProperty.call(t.purposes,n)&&!Object.prototype.hasOwnProperty.call(e.purposes,n)&&(e.purposes[n]=t.purposes[n]);e.protocols=t.protocols}this._consent.value=e;const r=yield this.getIdentities();try{const i=yield this.updateConsent(r,e,t);i&&void 0!==i.protocols&&(this._protocols.value=i.protocols),n&&(this._identityWatcher.stop(),"fds"===this._config.organization.code?this._identityWatcher.start(s.TraitName.IDENTITY,!1):yield this._identityWatcher.start(s.TraitName.IDENTITY,!1),this._userAttributeWatcher.stop(),yield this._userAttributeWatcher.start(s.TraitName.USER_ATTRIBUTE,!0),o||this.emit(E.default.USER_CONSENT_UPDATED_EVENT,e))}catch(e){let t="";e instanceof Error&&(t=e.message),i.warn("unable to update consent",t)}return e}))}setProvisionalConsent(e){return i.__awaiter(this,void 0,void 0,(function*(){f.default.debug("setProvisionalConsent",e),this._provisionalConsent=e}))}overrideWithProvisionalConsent(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=(0,u.wrapLogger)(f.default,"overrideWithProvisionalConsent");t.debug(e);let n=!1;if(!this._provisionalConsent)return t.trace("no provisional consent"),[e,n];for(const t in this._provisionalConsent.purposes)e.purposes[t]!==this._provisionalConsent.purposes[t]&&(e.purposes[t]=this._provisionalConsent.purposes[t],n=!0);return this._provisionalConsent=void 0,t.trace("merged",e),[e,n]}))}applyProvisionalConsent(e){var t,n;return i.__awaiter(this,void 0,void 0,(function*(){let i=structuredClone(e);const o=[...(null===(t=this._config.plugins)||void 0===t?void 0:t.onetrust)?[C.onetrustPlugin]:[],...(null===(n=this._config.plugins)||void 0===n?void 0:n.gpc)?[T.gpcPlugin]:[]];let r=!1,s=null;for(const e of o){const[t,n]=yield e.fn(this,i);n&&(i=t,r=!0,s=e.source)}return[i,r,s]}))}resetConsent(){return i.__awaiter(this,void 0,void 0,(function*(){return this._identityWatcher.stop(),yield this._identityWatcher.start(s.TraitName.IDENTITY,!1),this._userAttributeWatcher.stop(),yield this._userAttributeWatcher.start(s.TraitName.USER_ATTRIBUTE,!0),this._consent.reset(),this._config.options=Object.assign(Object.assign({},this._config.options),{"Cache-Control":"no-cache"}),this.getConsent()}))}getConsent(e=!1){return i.__awaiter(this,void 0,void 0,(function*(){return this._getConsent(e)}))}_getConsent(e=!1){var t;return i.__awaiter(this,void 0,void 0,(function*(){const n=(0,u.wrapLogger)(f.default,"getConsent");if(n.debug("getConsent promise created"),h.default.has(E.default.NO_CACHE)&&(e=!0,h.default.delete(E.default.NO_CACHE)),this.hasConsent()&&!e)return n.trace("has consent"),this._consent.fulfilled;n.debug("obtaining consent");const i=yield this.getIdentities(),o=yield this.fetchConsent(i,e);n.debug("storedConsent",o);let r,a=s.ConsentSource.LegalBasisDefault,c=!1;if(null===(t=this._config.options)||void 0===t?void 0:t.provisionalConsentPlugins){f.default.debug("provisionalConsentPlugins is enabled, using provisional consent plugins");const[e,t,n]=yield this.applyProvisionalConsent(o);c=t,r=t?e:o,n&&(a=n)}else{f.default.debug("provisionalConsentPlugins not enabled, using legacy behavior");const[e,t]=yield this.overrideWithProvisionalConsent(o);c=t,r=e}n.debug("consent",Object.assign(Object.assign({},r),{purposes:Object.assign({},r.purposes)})),n.debug("shouldCreatePermits",c);const d=this.selectExperience(r);if(this._config.purposes)for(const e of this._config.purposes)void 0!==r.purposes[e.code]||e.requiresOptIn||(r.purposes[e.code]=!0,c=!0);switch(n.debug("shouldCreatePermits",c),c?yield this.setConsent(r,a,!1):(this._consent.value=r,void 0!==o.protocols&&(this._protocols.value=o.protocols)),d){case s.ExperienceType.Consent:return this.showConsentExperience();case s.ExperienceType.Preference:return this.showPreferenceExperience()}return this._areRulesEnabled||this._hideExperienceReason.isFulfilled()&&this._hideExperienceReason.value===s.ExperienceClosedReason.WILL_NOT_SHOW||this.fireExperienceClosedEvents(s.ExperienceClosedReason.WILL_NOT_SHOW),this._consent.value}))}fireExperienceClosedEvents(e){e===s.ExperienceClosedReason.WILL_NOT_SHOW&&this.getIsExperienceDisplayed()||(this.emit(E.default.HIDE_EXPERIENCE_EVENT,e),this._hideExperienceReason.value=e)}retrieveConsent(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("retrieveConsent"),this._consent.isFulfilled()?this._consent.fulfilled:{purposes:{},vendors:[],googleVendors:[],vendorConsents:{tcf:{},google:{}}}}))}fetchConsent(e,t=!1){return i.__awaiter(this,void 0,void 0,(function*(){return this._fetchConsent(e,t)}))}_fetchConsent(e,t=!1){var n,o,r,s;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"fetchConsent");if(i.debug("fetchConsent promise created"),i.debug("identities",e),!e||0===Object.keys(e).length)throw _.default.noIdentitiesError;if(!(this._config&&this._config.property&&this._config.organization&&this._config.environment&&this._config.purposes&&this._config.jurisdiction&&0!==this._config.purposes.length))throw _.default.noPurposesError;let a=!1;window.navigator.globalPrivacyControl&&!0===window.navigator.globalPrivacyControl&&(a=!0);const c={organizationCode:null!==(n=this._config.organization.code)&&void 0!==n?n:"",propertyCode:null!==(o=this._config.property.code)&&void 0!==o?o:"",environmentCode:this._config.environment.code,jurisdictionCode:null!==(r=this._config.jurisdiction.code)&&void 0!==r?r:"",identities:e,purposes:{},isGpcEnabled:a};for(const e of this._config.purposes)c.purposes[e.code]={legalBasisCode:e.legalBasisCode};i.debug("request",c);let d=yield(0,g.getCachedConsent)(c,this._config);d.collectedAt&&(yield this.setProfile(b.ProfileSection.CONSENT_COLLECTED_AT,d.collectedAt));const l=Math.floor(Date.now()/1e3-g.CACHED_CONSENT_TTL);let p=!1,h=!1;if(t?i.debug("fetching consent due to noCache flag"):"local"===(null===(s=this._config.options)||void 0===s?void 0:s.consentStore)?p=!0:0===Object.keys(d.purposes).length?i.debug("cached consent is empty",d):(null==d?void 0:d.collectedAt)&&d.collectedAt<l?i.debug("revalidating cached consent",d):Object.keys(e).every((t=>e[t]===d.identities[t]))?(i.debug("using cached consent",d),p=!0):(h=!0,i.debug("cached consent discarded due to identity mismatch",e,d.identities)),!p){if(this._config.purposes&&d.purposes&&!h)for(const e of this._config.purposes){const t=d.purposes[e.code];t&&(c.purposes[e.code]||(c.purposes[e.code]={}),c.purposes[e.code].allowed="string"==typeof t?t:t.allowed)}i.debug("calling getConsent",JSON.stringify(c)),d=(e=>{var t;if(i.trace("normalizeConsent",e),!e.purposes)return e.purposes={},e;for(const n of Object.keys(e.purposes)){const i=e.purposes[n];"string"==typeof i&&(e.purposes[n]={allowed:i,legalBasisCode:null===(t=c.purposes[n])||void 0===t?void 0:t.legalBasisCode})}return i.trace("normalized",e),e})(yield this._api.getConsent(c)),i.debug("getConsent returned",JSON.stringify(d)),yield(0,g.setCachedConsent)(d,this._config),d.collectedAt&&(yield this.setProfile(b.ProfileSection.CONSENT_COLLECTED_AT,d.collectedAt))}yield(0,g.setPublicConsent)(d,this._config);const E={purposes:{}};if(this._config.purposes&&d.purposes)for(const e of this._config.purposes)if(d.purposes[e.code]){const t=d.purposes[e.code];"string"==typeof t?E.purposes[e.code]="true"===t:t.allowed&&(E.purposes[e.code]="true"===t.allowed)}d.vendors&&(E.vendors=d.vendors),d.googleVendors&&(E.googleVendors=d.googleVendors),d.protocols&&(E.protocols=d.protocols),d.vendorConsents&&(E.vendorConsents=d.vendorConsents);const v=this._calculateNeedsConsent(E.purposes);return this._needsConsent.isFulfilled()||(yield this.setProfile(b.ProfileSection.CONSENT_NEEDS_CONSENT,v),this._needsConsent.value=v),i.debug("returning",JSON.stringify(E)),yield this.setProfile(b.ProfileSection.CONSENT_PURPOSES,E.purposes),E}))}_calculateNeedsConsent(e){const t=(0,u.wrapLogger)(f.default,"_calculateNeedsConsent");if(this._config.purposes)for(const n of this._config.purposes)if(void 0===e[n.code])return t.debug("consent needed due to missing purpose consent",n.code),!0;return t.debug("consent not needed"),!1}fetchProtocols(e){var t,n,o;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"fetchProtocols");if(i.debug("identities",e),!e||0===Object.keys(e).length)throw _.default.noIdentitiesError;if(!(this._config&&this._config.property&&this._config.organization&&this._config.environment&&this._config.purposes&&this._config.jurisdiction&&0!==this._config.purposes.length))throw _.default.noPurposesError;let r=!1;window.navigator.globalPrivacyControl&&!0===window.navigator.globalPrivacyControl&&(r=!0);const s={organizationCode:null!==(t=this._config.organization.code)&&void 0!==t?t:"",propertyCode:null!==(n=this._config.property.code)&&void 0!==n?n:"",environmentCode:this._config.environment.code,jurisdictionCode:null!==(o=this._config.jurisdiction.code)&&void 0!==o?o:"",identities:e,purposes:{},isGpcEnabled:r};for(const e of this._config.purposes)s.purposes[e.code]={legalBasisCode:e.legalBasisCode};const a=yield this._api.getProtocols(s);return i.debug("api.getProtocols returned",JSON.stringify(a)),!this._protocols.isFulfilled()&&a.protocols&&(i.debug("setting protocols",JSON.stringify(a.protocols)),this._protocols.value=a.protocols),{protocols:null==a?void 0:a.protocols,purposes:{}}}))}updateConsent(e,t,n){var o,r,s;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"updateConsent");i.debug(e,t);const a=yield this.getFullConfig();if(!e||0===Object.keys(e).length)throw i.debug("no identities"),_.default.noIdentitiesError;if(!(this._config&&this._config.organization&&this._config.property&&this._config.environment&&this._config.jurisdiction&&this._config.purposes&&0!==this._config.purposes.length))throw i.debug("invalid configuration"),_.default.invalidConfigurationError;if((0,p.default)(t)||(0,p.default)(t.purposes))throw i.debug("empty consent"),_.default.emptyConsentError;const c=!(!window.navigator.globalPrivacyControl||!0!==window.navigator.globalPrivacyControl),d={organizationCode:null!==(o=this._config.organization.code)&&void 0!==o?o:"",propertyCode:null!==(r=this._config.property.code)&&void 0!==r?r:"",environmentCode:this._config.environment.code,identities:e,jurisdictionCode:null!==(s=this._config.jurisdiction.code)&&void 0!==s?s:"",purposes:{},vendorConsents:t.vendorConsents,collectedAt:Math.floor(Date.now()/1e3),isGpcEnabled:c,context:{source:n}};if((null==a?void 0:a.id)&&d.context&&(d.context.configurationId=a.id),this._config.purposes&&t)for(const e of this._config.purposes)void 0!==t.purposes[e.code]&&(d.purposes[e.code]={allowed:t.purposes[e.code].toString(),legalBasisCode:e.legalBasisCode});if((0,p.default)(d.purposes))return i.debug("calculated consents empty"),d;yield(0,g.setCachedConsent)(d,this._config),yield(0,g.setPublicConsent)(d,this._config);const l=yield this._api.setConsent(d);yield(0,g.setCachedConsent)(l,this._config);const h=Object.keys(l.purposes).reduce(((e,t)=>(e[t]=l.purposes[t].allowed,e)),{});return yield this.setProfile(b.ProfileSection.CONSENT_PURPOSES,h),l}))}getSubscriptions(){return i.__awaiter(this,void 0,void 0,(function*(){return this._getSubscriptions()}))}_getSubscriptions(){var e,t,n,o,r,s,a,c;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"getSubscriptions");if(i.debug("getSubscriptions promise created"),void 0===this._config.organization||void 0===this._config.property||void 0===this._config.environment)return i.trace("exiting because invalid config",this._config),this._subscriptions.value={},{};if(this._subscriptions.isFulfilled())return i.trace("cached",this._subscriptions.value),this._subscriptions;const d=yield this.getSubscriptionConfiguration();if(0===d.topics.length||void 0===d.identities||0===Object.keys(d.identities).length)return i.trace("exiting because invalid subscription config",d,d.topics.length,d.identities,Object.keys(d.identities)),this._subscriptions.value={},{};const l={organizationCode:null!==(n=null===(t=null===(e=this._config)||void 0===e?void 0:e.organization)||void 0===t?void 0:t.code)&&void 0!==n?n:"",controllerCode:"",propertyCode:null!==(s=null===(r=null===(o=this._config)||void 0===o?void 0:o.property)||void 0===r?void 0:r.code)&&void 0!==s?s:"",environmentCode:null===(c=null===(a=this._config)||void 0===a?void 0:a.environment)||void 0===c?void 0:c.code,collectedAt:Math.floor(Date.now()/1e3),identities:{}},p=yield this.getIdentities();for(const e of Object.keys(d.identities))p[e]&&(l.identities[e]=p[e]);if(0===Object.keys(l.identities).length)return i.trace("exiting because no identities"),this._subscriptions.value={},{};const _=yield this._api.getSubscriptions(l);return this._subscriptions.value=_,i.trace("loaded",_),yield this.setProfile(b.ProfileSection.SUBSCRIPTION,_),_}))}setSubscriptions(e,t){var n,o,r,s,a,c,d,l;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"setSubscriptions");if(i.trace("subscriptions",e,this._config),void 0===this._config.organization||void 0===this._config.property||void 0===this._config.environment)return void i.trace("exiting because of invalid config");const p=yield this.getSubscriptionConfiguration(),_=yield this.getFullConfig();if(0===p.topics.length||void 0===p.identities||0===Object.keys(p.identities).length)return void i.trace("exiting because of invalid subscription config",p,0===p.topics.length,p.identities,Object.keys(p.identities));const h={organizationCode:null!==(r=null===(o=null===(n=this._config)||void 0===n?void 0:n.organization)||void 0===o?void 0:o.code)&&void 0!==r?r:"",controllerCode:"",propertyCode:null!==(c=null===(a=null===(s=this._config)||void 0===s?void 0:s.property)||void 0===a?void 0:a.code)&&void 0!==c?c:"",environmentCode:null===(l=null===(d=this._config)||void 0===d?void 0:d.environment)||void 0===l?void 0:l.code,topics:e.topics,controls:e.controls,collectedAt:Math.floor(Date.now()/1e3),context:{source:t}};(null==_?void 0:_.id)&&h.context&&(h.context.configurationId=_.id),h.identities={};const g=yield this.getIdentities();for(const e of Object.keys(p.identities))g[e]&&(h.identities[e]=g[e]);return 0===Object.keys(h.identities).length?(i.trace("exiting because no identities"),void(this._subscriptions.value={})):(this._subscriptions.value=Object.assign(Object.assign({},this._subscriptions.isFulfilled()?this._subscriptions.value:{}),e),yield this.setProfile(b.ProfileSection.SUBSCRIPTION,e),this._api.setSubscriptions(h))}))}getSubscriptionConfiguration(){var e,t,n,o,r,s,a,c,d,l,p,_,h,g,E,v,y,b,C,T,m,O,w,N,S,I;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"getSubscriptionConfiguration");if(i.trace("config",this._config),this._subscriptionConfig.isFulfilled())return i.trace("cached",this._subscriptionConfig.value),this._subscriptionConfig;if(!(null===(n=null===(t=null===(e=this._config)||void 0===e?void 0:e.experiences)||void 0===t?void 0:t.preference)||void 0===n?void 0:n.code)||(null===(s=null===(r=null===(o=this._config)||void 0===o?void 0:o.services)||void 0===r?void 0:r.shoreline)||void 0===s?void 0:s.includes("v3"))){const e=this._config;return e.subscription?e.subscription:(this._subscriptionConfig.value={contactMethods:{},controls:[],identities:{},language:null!==(c=null===(a=this._config)||void 0===a?void 0:a.language)&&void 0!==c?c:"",organization:{code:null!==(p=null===(l=null===(d=this._config)||void 0===d?void 0:d.organization)||void 0===l?void 0:l.code)&&void 0!==p?p:""},property:{code:null!==(g=null===(h=null===(_=this._config)||void 0===_?void 0:_.property)||void 0===h?void 0:h.code)&&void 0!==g?g:""},topics:[]},this._subscriptionConfig.value)}const A=yield this._api.getSubscriptionsConfiguration({organizationCode:null!==(y=null===(v=null===(E=this._config)||void 0===E?void 0:E.organization)||void 0===v?void 0:v.code)&&void 0!==y?y:"",propertyCode:null!==(T=null===(C=null===(b=this._config)||void 0===b?void 0:b.property)||void 0===C?void 0:C.code)&&void 0!==T?T:"",languageCode:null!==(O=null===(m=this._config)||void 0===m?void 0:m.language)&&void 0!==O?O:"",experienceCode:null!==(I=null===(S=null===(N=null===(w=this._config)||void 0===w?void 0:w.experiences)||void 0===N?void 0:N.preference)||void 0===S?void 0:S.code)&&void 0!==I?I:""});return i.trace("loaded",A),this._subscriptionConfig.value=A,A}))}setEnvironment(e){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("setEnvironment",e),this._environment.value=e,this._environment.fulfilled}))}getEnvironment(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getEnvironment"),this._environment.fulfilled}))}setGeoIP(e){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("setGeoIP",e),this._geoip.value=e,this._geoip.fulfilled}))}getGeoIP(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getGeoIP"),this._geoip.fulfilled}))}extractGAID(e){const t=/^GA\d\.\d\.(\d+\.\d+)$/.exec(e);return t?"GA1.1."+t[1]:e}setIdentities(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=(0,u.wrapLogger)(f.default,"setIdentities");t.debug(e);let n={};this._identities.isFulfilled()&&(n=this._identities.value);for(const i in e)"google_analytics_cookie"!==i||"utc"!==this._config.organization.code&&"vara_labs"!==this._config.organization.code||(t.debug("altering google_analytics_cookie to get id with GA1.1. prefix"),e[i]=this.extractGAID(e[i])),n[i]=e[i];if(n.email&&(n.email=n.email.toLowerCase()),this._identities.value=n,this._identitiesCurrent=n,yield this.setProfile(b.ProfileSection.IDENTITIES,n),this._isExperienceDisplayed)return t.trace("experience displayed"),n;const i=yield this.retrieveConsent();if(0==Object.keys(i.purposes).length)return n;const o=yield this.fetchConsent(n);if((0,c.default)(o.purposes,i.purposes)){let e=!1;for(const t in o)if(o.purposes[t]!==i.purposes[t]){e=!0;break}if(!e)return n}if(this._hasExperienceBeenDisplayed){t.trace("updating consent because experience displayed");try{yield this.updateConsent(n,i,s.ConsentSource.LateArrivingID)}catch(e){let n="";e instanceof Error&&(n=e.message),t.warn("unable to update consent",n)}return n}return yield this.showConsentExperience(),n}))}collectIdentities(){var e,t,n;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"collectIdentities");i.debug(this._config.identities);const o=this._config.identities;if(!this._config||!this._config.organization||void 0===o||(0,p.default)(o))return i.trace("invalid configuration"),void(this._identities.value={});const r=this._identityWatcher;let a=(e,t)=>{r.add(e,t)};if(null===(e=this._config.property)||void 0===e?void 0:e.proxy)try{const e=new URL(null===(t=this._config.property)||void 0===t?void 0:t.proxy),n=new URL(window.location.href);if(e.origin!==n.origin&&(a=(e,t)=>{o[e].type!==s.IdentityType.IDENTITY_TYPE_LOCAL_STORAGE&&r.add(e,t)},!this._hasProxyLoaded)){this._hasProxyLoaded=!0,yield d.proxy.open(e.toString());for(const e of Object.keys(o)){const t=o[e];t.type===s.IdentityType.IDENTITY_TYPE_LOCAL_STORAGE&&(yield this.registerIdentityProvider(e,(()=>d.proxy.invoke("getIdentity",t))))}}}catch(e){i.error(`error checking proxy '${null===(n=this._config.property)||void 0===n?void 0:n.proxy}'`,e)}for(const e of Object.keys(o))a(e,o[e]);i.info("starting watcher"),yield this._identityWatcher.start(s.TraitName.IDENTITY,!1)}))}getIdentities(){return i.__awaiter(this,void 0,void 0,(function*(){return this._getIdentities()}))}_getIdentities(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getIdentities promise created"),this._identities.isFulfilled()||(yield this.collectIdentities()),this._identities.fulfilled}))}getCurrentIdentities(){return f.default.debug("getCurrentIdentities"),this._identitiesCurrent}setUserAttributes(e){return i.__awaiter(this,void 0,void 0,(function*(){(0,u.wrapLogger)(f.default,"setUserAttributes").debug(e);let t={};this._userAttributes.isFulfilled()&&(t=this._userAttributes.value);for(const n in e)t[n]=e[n];return this._userAttributes.value=t,yield this.setProfile(b.ProfileSection.USER,t),t}))}collectUserAttributes(){return i.__awaiter(this,void 0,void 0,(function*(){const e=(0,u.wrapLogger)(f.default,"collectUserAttributes");e.debug(this._config.userAttributes);const t=this._config.userAttributes;if(!this._config||!this._config.organization||void 0===t||(0,p.default)(t))return e.trace("invalid configuration"),void(this._userAttributes.value={});const n=this._userAttributeWatcher;let i=(e,t)=>{n.add(e,t)};for(const e of Object.keys(t))i(e,t[e]);e.info("starting user attributes watcher"),yield this._userAttributeWatcher.start(s.TraitName.USER_ATTRIBUTE,!0)}))}getUserAttributes(){return i.__awaiter(this,void 0,void 0,(function*(){return this._getUserAttributes()}))}_getUserAttributes(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getUserAttributes"),this._userAttributes.isFulfilled()||(yield this.collectUserAttributes()),this._userAttributes.fulfilled}))}getCurrentUserAttributes(){return f.default.debug("getCurrentUserAttributes"),this._userAttributes.isFulfilled()?this._userAttributes.value:{}}setProfile(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n=(0,u.wrapLogger)(f.default,"setProfile");n.debug(t),this._profileManager.updateSection(e,t);const i=this._profileManager.getCurrentProfile();return n.debug("profile",i),i}))}getProfileManager(){return this._profileManager}getCurrentProfile(){return this._profileManager.getCurrentProfile()}getAreRulesEnabled(){return this._areRulesEnabled}setJurisdiction(e){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("setJurisdiction",e),this._jurisdiction.value=e,this._jurisdiction.fulfilled}))}getJurisdiction(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getJurisdiction"),this._jurisdiction.fulfilled}))}setRegionInfo(e){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("setRegionInfo",e),this._regionInfo.value=e,this._regionInfo.fulfilled}))}getRegionInfo(){return i.__awaiter(this,void 0,void 0,(function*(){return f.default.debug("getRegionInfo"),this._regionInfo.fulfilled}))}getIsExperienceDisplayed(){return f.default.debug("getIsExperienceDisplayed"),this._isExperienceDisplayed}acceptAllConsent(){return i.__awaiter(this,void 0,void 0,(function*(){return this.executeConsentAction("accept",s.ConsentSource.RouterAcceptAllConsent)}))}rejectAllConsent(){return i.__awaiter(this,void 0,void 0,(function*(){return this.executeConsentAction("reject",s.ConsentSource.RouterRejectAllConsent)}))}executeConsentAction(e,t){var n,o,r,a,c,d,l,p,h,v,y,b,C;return i.__awaiter(this,void 0,void 0,(function*(){(0,u.wrapLogger)(f.default,`${e}AllConsent`).debug(`set consent via ${e}AllConsent`);const i="true"===(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(E.default.EMULATOR_OVERRIDE_CONSENT)),T=(null===(o=null===(n=this._config)||void 0===n?void 0:n.systems)||void 0===o?void 0:o.google)||[],m=(null===(a=null===(r=this._config)||void 0===r?void 0:r.systems)||void 0===a?void 0:a.tcf)||[],O={purposes:{},vendorConsents:{google:{},tcf:{}}},w={organizationCode:null!==(c=this._config.organization.code)&&void 0!==c?c:"",propertyCode:null!==(l=null===(d=this._config.property)||void 0===d?void 0:d.code)&&void 0!==l?l:"",environmentCode:null!==(h=null===(p=this._config.environment)||void 0===p?void 0:p.code)&&void 0!==h?h:"",jurisdictionCode:null!==(y=null===(v=this._config.jurisdiction)||void 0===v?void 0:v.code)&&void 0!==y?y:"",identities:{},purposes:{},collectedAt:Date.now()};this._config.purposes&&this._config.purposes.forEach((t=>{let n;n="accept"===e||"disclosure"===(null==t?void 0:t.legalBasisCode),O.purposes[t.code]=n,w.purposes[t.code]={allowed:n.toString(),legalBasisCode:null==t?void 0:t.legalBasisCode}}));const N="accept"===e?s.VendorStatus.Granted:s.VendorStatus.Denied;if((null==T?void 0:T.length)&&(null===(b=O.vendorConsents)||void 0===b?void 0:b.google)&&T.forEach((e=>{O.vendorConsents.google[e.id]=N})),(null==m?void 0:m.length)&&(null===(C=O.vendorConsents)||void 0===C?void 0:C.tcf)&&m.forEach((e=>{O.vendorConsents.tcf[e.id]=N})),i)this._identityWatcher.removeAllListeners(E.default.IDENTITY_EVENT),this._userAttributeWatcher.removeAllListeners(E.default.USER_ATTRIBUTE_EVENT),yield(0,g.setCachedConsent)(w,this._config),yield(0,g.setPublicConsent)(w,this._config),this._consent.reset(),this._consent.value=O;else{const e=yield this.getIdentities();if(!e||0===Object.keys(e||{}).length)throw _.default.noIdentitiesError;w.identities=e,yield this.setConsent(O,t,!1)}const S=E.default.ROUTER_ACCEPT_ALL_CONSENT_FLAG,I=E.default.ROUTER_REJECT_ALL_CONSENT_FLAG;return"accept"===e?(sessionStorage.removeItem(I),sessionStorage.setItem(S,"true")):(sessionStorage.removeItem(S),sessionStorage.setItem(I,"true")),{getConsentResponse:w,consent:O}}))}invokeRight(e){var t,n,o,r;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,u.wrapLogger)(f.default,"invokeRight");if(i.debug(e),!e.subject||!e.subject.email||""===e.subject.email||!e.right||""===e.right)return void i.warn("invalid right invocation request");const s={};if(this._identities.isFulfilled()&&Object.entries(this._identities.value).forEach((([e,t])=>{s[e]=t})),s.email=e.subject.email.toLowerCase(),!(this._config&&this._config.organization&&this._config.property&&this._config.environment&&this._config.jurisdiction&&this._config.rights&&0!==this._config.rights.length))return void i.warn("invalid configuration");const a=e.subject,c={organizationCode:null!==(t=this._config.organization.code)&&void 0!==t?t:"",propertyCode:null!==(n=this._config.property.code)&&void 0!==n?n:"",environmentCode:null!==(o=this._config.environment.code)&&void 0!==o?o:"",controllerCode:"",identities:s,jurisdictionCode:null!==(r=this._config.jurisdiction.code)&&void 0!==r?r:"",rightCode:e.right,user:a,recaptchaToken:e.recaptchaToken};return this._regionInfo.isFulfilled()&&(c.regionCode=yield this._regionInfo.fulfilled),this.emit(E.default.RIGHT_INVOKED_EVENT,c),this._api.invokeRight(c)}))}handleKeyboardEvent(e){(0,u.wrapLogger)(f.default,"handleKeyboardEvent").debug(e),(0,l.default)(e,(()=>{this.returnKeyboardControl()}))}returnKeyboardControl(){(0,u.wrapLogger)(f.default,"returnKeyboardControl").debug("returnKeyboardControl"),this.emit(E.default.RETURN_KEYBOARD_CONTROL)}emit(e,...t){var n,i,o,r,s,a,c;const d=(0,u.wrapLogger)(f.default,"emit");d.trace(e,t);const l=e.toString(),p=t.filter((e=>e!==this));if(window.androidListener||(null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers)||(null===(i=window.ReactNativeWebView)||void 0===i?void 0:i.postMessage)){let t;1===p.length&&"string"==typeof p[0]?t=p[0]:1===p.length?t=JSON.stringify(p[0]):p.length>1&&(t=JSON.stringify(p)),window.androidListener&&l in window.androidListener?(d.trace("androidListener",window.androidListener,t),0===p.length?window.androidListener[l]():window.androidListener[l](t)):(null===(o=window.webkit)||void 0===o?void 0:o.messageHandlers)&&l in window.webkit.messageHandlers?(d.trace("webkitMessageHandlers",null===(r=window.webkit)||void 0===r?void 0:r.messageHandlers,t),window.webkit.messageHandlers[l].postMessage(t)):(null===(s=window.ReactNativeWebView)||void 0===s?void 0:s.postMessage)?window.ReactNativeWebView.postMessage(JSON.stringify({event:e,data:t})):d.warn(`Can't pass message to native code because "${l}" handler is not registered`)}if((null===(c=null===(a=this._config)||void 0===a?void 0:a.options)||void 0===c?void 0:c.externalListener)&&window[this._config.options.externalListener]){const e=window[this._config.options.externalListener];let t;1===p.length&&"string"==typeof p[0]||1===p.length?t=p[0]:p.length>1&&(t=p);let n={event:l,data:t};n=JSON.stringify(n),"function"==typeof e?e(n):"postMessage"in e&&"function"==typeof e.postMessage?e.postMessage(n):"object"==typeof e&&l in e&&("function"===e[l]?e[l](t):"postMessage"in e[l]&&e[l].postMessage(t))}return super.emit(e,...t)}addListener(e,t){return this.on(e,t)}on(e,t){f.default.trace("on",e,t);const n=this.mapEvent(e);return void 0!==n?(n.on(E.default.FULFILLED_EVENT,t),this):(this.isSingletonEvent(e)&&super.removeAllListeners(e),super.on(e,t),this.emit("addedListener",e,t),this)}once(e,t){f.default.trace("once",e,t);const n=this.mapEvent(e);return void 0!==n?(n.once(E.default.FULFILLED_EVENT,t),this):(this.isSingletonEvent(e)&&super.removeAllListeners(e),super.once(e,t),this.emit("addedListener",e,t),this)}removeListener(e,t){f.default.trace("off",e,t);const n=this.mapEvent(e);return void 0!==n?(n.removeListener(E.default.FULFILLED_EVENT,t),this):super.removeListener(e,t)}off(e,t){return this.removeListener(e,t)}isSingletonEvent(e){return e===E.default.SHOW_CONSENT_EXPERIENCE_EVENT||e===E.default.SHOW_PREFERENCE_EXPERIENCE_EVENT}mapEvent(e){switch(e){case E.default.CONSENT_EVENT:return this._consent;case E.default.ENVIRONMENT_EVENT:return this._environment;case E.default.GEOIP_EVENT:return this._geoip;case E.default.PROTOCOLS_EVENT:return this._protocols;case E.default.HANDLE_KEYBOARD_EVENT:return this._handleKeyboardEvent;case E.default.IDENTITIES_EVENT:return this._identities;case E.default.USER_ATTRIBUTES_EVENT:return this._userAttributes;case E.default.JURISDICTION_EVENT:return this._jurisdiction;case E.default.REGION_INFO_EVENT:return this._regionInfo;case E.default.RETURN_KEYBOARD_CONTROL:return this._returnKeyboardControl;case E.default.SUBSCRIPTIONS_EVENT:return this._subscriptions;case E.default.SUBSCRIPTION_CONFIG_EVENT:return this._subscriptionConfig;case E.default.HIDE_EXPERIENCE_REASON_EVENT:return this._hideExperienceReason}}}t.Ketch=m},7893:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileManager=t.ProfileSection=void 0;const i=n(1635),o=n(5305),r=i.__importDefault(n(7931));var s;!function(e){e.CONSENT_PURPOSES="consent.purposes",e.CONSENT_NEEDS_CONSENT="consent.needsConsent",e.CONSENT_COLLECTED_AT="consent.collectedAt",e.IDENTITIES="identities",e.USER="user",e.SUBSCRIPTION="subscription"}(s=t.ProfileSection||(t.ProfileSection={})),t.ProfileManager=class{constructor(e){this._profile={consent:{}},this._ketch=e}getValueFromKey(e){return i.__awaiter(this,void 0,void 0,(function*(){(0,o.wrapLogger)(r.default,"ProfileManager.getValueFromKey").debug("getting value from key",e);const t=e.split(".");let n,i=!0;for(;i;){n=this._profile,i=!1;for(const e of t)if(n=n[e],void 0===n){const n=t.slice(0,t.indexOf(e)+1).join(".");if(!(yield this._handleMissingKey(n)))return;i=!0;break}}return"identities"===t[0]||"user"===t[0]?n.value:n}))}_handleMissingKey(e){return i.__awaiter(this,void 0,void 0,(function*(){switch((0,o.wrapLogger)(r.default,"ProfileManager._handleMissingKey").debug("handling missing key",e),e){case s.CONSENT_PURPOSES:case s.CONSENT_NEEDS_CONSENT:case s.CONSENT_COLLECTED_AT:return yield this._ketch.getConsent(),!0;case s.IDENTITIES:return yield this._ketch.getIdentities(),!0;case s.USER:return yield this._ketch.getUserAttributes(),!0;case s.SUBSCRIPTION:return yield this._ketch.getSubscriptions(),!0;default:return}}))}updateSection(e,t){const n=(0,o.wrapLogger)(r.default,"ProfileManager.updateSection");switch(n.debug("updating section",e,t),e){case s.CONSENT_PURPOSES:const e=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,{allowed:String(t)}])));this._profile.consent.purposes=e;break;case s.CONSENT_NEEDS_CONSENT:this._profile.consent.needsConsent=t;break;case s.CONSENT_COLLECTED_AT:this._profile.consent.collectedAt=t;break;case s.SUBSCRIPTION:this._profile.subscription=t;break;case s.IDENTITIES:const n=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,{value:t}])));this._profile.identities=n;break;case s.USER:const i=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,{value:t}])));this._profile.user=i}n.debug("updated profile",this._profile)}getCurrentProfile(){return(0,o.wrapLogger)(r.default,"ProfileManager.getCurrentProfile").debug("current profile",this._profile),Object.assign({},this._profile)}}},3004:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(8509),r=i.__importDefault(n(7931)),s=i.__importDefault(n(5834)),a=i.__importDefault(n(8705)),c=i.__importDefault(n(6092)),u=n(5305);t.default=class{constructor(e){this._ketch=e}push(e){if(void 0===e)return;let t;"string"==typeof e?(t=e,e=[]):(e=Array.from(e),t=e.shift()),r.default.trace(t),this.route(t,...e).then((()=>{r.default.trace(`${t} completed`)})).catch((e=>{r.default.warn(`${t} failed: ${e}`)}))}route(e,...t){return i.__awaiter(this,void 0,void 0,(function*(){const n=(0,u.wrapLogger)((0,u.wrapLogger)(r.default,"route"),e);if("push"===e||"route"===e)throw s.default.actionNotFoundError(e);const i=this[e];if(void 0===i)throw s.default.actionNotFoundError(e);if(n.debug(t,t.length,i.length),t.length<=i.length)return i.apply(this,t);if(t.length==i.length+1){const n=t.pop();if(!(0,a.default)(n))throw s.default.expectedFunctionError(e);return i.apply(this,t).then(n)}const o=t.pop();if(!(0,a.default)(o))throw s.default.expectedFunctionError(e);const c=t.pop();if(!(0,a.default)(c))throw s.default.expectedFunctionError(e);return i.apply(this,t).then(c).catch(o)}))}getConfig(){return this._ketch.getConfig()}getFullConfig(){return this._ketch.getFullConfig()}getConsent(){return this._ketch.getConsent()}getConsentNoCache(){return this._ketch.getConsent(!0)}getSubscriptions(){return this._ketch.getSubscriptions()}getEnvironment(){return this._ketch.getEnvironment()}getGeoIP(){return this._ketch.getGeoIP()}getIdentities(){return this._ketch.getIdentities()}getJurisdiction(){return this._ketch.getJurisdiction()}getRegionInfo(){return this._ketch.getRegionInfo()}getIsDisplayed(){return Promise.resolve(this._ketch.getIsExperienceDisplayed())}onConsent(e){return r.default.debug(`onConsent is deprecated - use ketch("on", "${c.default.CONSENT_EVENT}", listener) instead`),this._ketch.on(c.default.CONSENT_EVENT,e),Promise.resolve()}onEnvironment(e){return r.default.debug(`onEnvironment is deprecated - use ketch("on", "${c.default.ENVIRONMENT_EVENT}", listener) instead`),this._ketch.on(c.default.ENVIRONMENT_EVENT,e),Promise.resolve()}onGeoIP(e){return r.default.debug(`onGeoIP is deprecated - use ketch("on", "${c.default.GEOIP_EVENT}", listener) instead`),this._ketch.on(c.default.GEOIP_EVENT,e),Promise.resolve()}onHideExperience(e){return r.default.debug(`onHideExperience is deprecated - use ketch("on", "${c.default.HIDE_EXPERIENCE_EVENT}", listener) instead`),this._ketch.on(c.default.HIDE_EXPERIENCE_EVENT,e),Promise.resolve()}onWillShowExperience(e){return r.default.debug('onWillShowExperience is deprecated - use ketch("on", "'+c.default.WILL_SHOW_EXPERIENCE_EVENT+'", listener) instead'),this._ketch.on(c.default.WILL_SHOW_EXPERIENCE_EVENT,e),Promise.resolve()}onIdentities(e){return r.default.debug(`onIdentities is deprecated - use ketch("on", "${c.default.IDENTITIES_EVENT}", listener) instead`),this._ketch.on(c.default.IDENTITIES_EVENT,e),Promise.resolve()}onJurisdiction(e){return r.default.debug(`onJurisdiction is deprecated - use ketch("on", "${c.default.JURISDICTION_EVENT}", listener) instead`),this._ketch.on(c.default.JURISDICTION_EVENT,e),Promise.resolve()}onRegionInfo(e){return r.default.debug(`onRegionInfo is deprecated - use ketch("on", "${c.default.REGION_INFO_EVENT}", listener) instead`),this._ketch.on(c.default.REGION_INFO_EVENT,e),Promise.resolve()}setEnvironment(e){return r.default.warn("setEnvironment is deprecated"),this._ketch.setEnvironment(e).then((()=>{}))}setGeoIP(e){return r.default.warn("setGeoIP is deprecated"),this._ketch.setGeoIP(e).then((()=>{}))}setIdentities(e){return this._ketch.setIdentities(e).then((()=>{}))}setUserAttributes(e){return this._ketch.setUserAttributes(e).then((()=>{}))}setJurisdiction(e){return r.default.warn("setJurisdiction is deprecated"),this._ketch.setJurisdiction(e).then((()=>{}))}setRegionInfo(e){return r.default.warn("setRegionInfo is deprecated"),this._ketch.setRegionInfo(e).then((()=>{}))}showConsent(e){return this._ketch.showConsentExperience(e).then((()=>{}))}showPreferences(e){return this._ketch.showPreferenceExperience(e).then((()=>{}))}showConsentGate(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this._ketch.showConsentGate(e)}))}showProgressiveExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this._ketch.showProgressiveExperience(e)}))}showExperience(e){return i.__awaiter(this,void 0,void 0,(function*(){return this._ketch.showExperience(e)}))}trigger(e,t){return i.__awaiter(this,void 0,void 0,(function*(){return this._ketch.trigger(e,t)}))}reinit(){return this._ketch.resetConsent().then((()=>{}))}handleKeyboardEvent(e){return this._ketch.handleKeyboardEvent(e)}returnKeyboardControl(){return this._ketch.returnKeyboardControl()}registerPlugin(e,t){return this._ketch.registerPlugin(e,t)}registerIdentityProvider(e,t){return this._ketch.registerIdentityProvider(e,t)}registerExperienceServer(e){return this._ketch.registerExperienceServer(e)}registerStorageProvider(e,t){return this._ketch.registerStorageProvider(e,t)}setConsent(e,t){return this._ketch.setConsent(e,o.ConsentSource.RouterSetConsent,t===o.SetConsentReason.USER_UPDATE).then((()=>{}))}setSubscriptions(e,t){return this._ketch.setSubscriptions(e,null!=t?t:o.SubscriptionSource.RouterSetSubscriptions)}setProfile(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this._ketch.setProfile(e,t)}))}acceptAllConsent(){return i.__awaiter(this,void 0,void 0,(function*(){yield this._ketch.acceptAllConsent(),window.location.reload()}))}rejectAllConsent(){return i.__awaiter(this,void 0,void 0,(function*(){yield this._ketch.rejectAllConsent(),window.location.reload()}))}emit(e,...t){return this._ketch.emit(e,...t),Promise.resolve()}on(e,t){return this._ketch.on(e,t),Promise.resolve()}once(e,t){return this._ketch.once(e,t),Promise.resolve()}addListener(e,t){return this._ketch.addListener(e,t),Promise.resolve()}removeListener(e,t){return this._ketch.removeListener(e,t),Promise.resolve()}off(e,t){return this._ketch.off(e,t),Promise.resolve()}removeAllListeners(e){return this._ketch.removeAllListeners(e),Promise.resolve()}}},6122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateRules=void 0;const i=n(1635),o=n(5305),r=i.__importDefault(n(7931)),s=n(8509);t.evaluateRules=(e,t,n,c,u)=>i.__awaiter(void 0,void 0,void 0,(function*(){var i;const d=(0,o.wrapLogger)(r.default,"evaluateRules");d.debug("evaluating rules for trigger",e,{rules:t,params:c,source:u});const l=new Map;for(const i of t){d.debug("evaluating rule for trigger",e,{rule:i});const t=yield a(i.condition,n);if(l.set(i.code,t),t)return d.debug("executing rule for trigger",e,{rule:i}),yield p(i.action,n,c,u),l}return(null===(i=n.hideExperienceReason)||void 0===i?void 0:i.isFulfilled())&&(yield n.hideExperienceReason)===s.ExperienceClosedReason.WILL_NOT_SHOW||n.fireExperienceClosedEvents(s.ExperienceClosedReason.WILL_NOT_SHOW),l}));const a=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){if("inputDataKey"in e)return d(e,t);switch(e.operator){case s.ConditionOperator.NOT:const n=e;return!(yield a(n.operand,t));case s.ConditionOperator.AND:const i=e;for(const e of i.operands)if(!(yield a(e,t)))return!1;return!0;case s.ConditionOperator.OR:const o=e;for(const e of o.operands)if(yield a(e,t))return!0;return!1;default:throw console.error(`Unknown condition operator: ${e.operator}`),new Error(`Unknown condition operator: ${e.operator}`)}})),c=(e,t)=>{if(null==e)return e;switch(t){case"number":const t=Number(e);return isNaN(t)?void 0:t;case"boolean":return"boolean"==typeof e?e:"string"==typeof e?"true"===e.toLowerCase()||"1"===e:Boolean(e);case"date":return u(e);case"object":return e;default:return String(e)}},u=e=>{if(e instanceof Date)return e;if("number"==typeof e||"string"==typeof e&&/^\d+$/.test(e)){const t=Number(e),n=new Date(t);return isNaN(n.getTime())?void 0:n}const t=new Date(e);return isNaN(t.getTime())?void 0:t},d=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){const n=(0,o.wrapLogger)(r.default,"evaluateOperand");n.debug("evaluating operand",{operand:e});const{inputDataKey:i,type:a,operator:u,value:d}=e;if("trigger"===i.split(".")[0]||"jurisdiction"===i.split(".")[0])return n.debug("operand is trigger or jurisdiction, returning true"),!0;const p=yield l(i,t),f=c(p,a),_=c(d,a);let h;switch(u){case s.OperatorType.EQUALS:h=f===_;break;case s.OperatorType.NOT_EQUALS:h=f!==_;break;case s.OperatorType.GREATER_THAN:h=("number"==typeof f&&"number"==typeof _||f instanceof Date&&_ instanceof Date)&&f>_;break;case s.OperatorType.LESS_THAN:h=("number"==typeof f&&"number"==typeof _||f instanceof Date&&_ instanceof Date)&&f<_;break;case s.OperatorType.GREATER_THAN_OR_EQUAL:h=("number"==typeof f&&"number"==typeof _||f instanceof Date&&_ instanceof Date)&&f>=_;break;case s.OperatorType.LESS_THAN_OR_EQUAL:h=("number"==typeof f&&"number"==typeof _||f instanceof Date&&_ instanceof Date)&&f<=_;break;case s.OperatorType.CONTAINS:h="string"==typeof f&&"string"==typeof _&&f.includes(_);break;case s.OperatorType.REGEX_MATCH_FIND:if("string"==typeof f&&"string"==typeof _)try{h=new RegExp(_).test(f)}catch(e){console.warn(`Invalid regex pattern: ${_}`),h=!1}else h=!1;break;case s.OperatorType.EXISTS:h=null!=f,h&&"object"==typeof f&&(h=Object.keys(f).length>0);break;case s.OperatorType.NOT_EXISTS:h=null==f,h||"object"!=typeof f||(h=0===Object.keys(f).length);break;case s.OperatorType.IN:h="string"==typeof _?_.split(",").map((e=>e.trim())).includes(String(f)):!!Array.isArray(_)&&_.includes(f);break;default:console.warn(`Unknown operator: ${u}`),h=!1}return n.debug("result",{convertedCurrentValue:f,convertedValue:_,operator:u,result:h}),h})),l=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){if((0,o.wrapLogger)(r.default,"resolveInputDataKey").debug("resolving input data key",e),e)return yield t.getProfileManager().getValueFromKey(e)})),p=(e,t,n,o)=>i.__awaiter(void 0,void 0,void 0,(function*(){const{experienceID:i}=e.params;let{experienceType:a}=e.params;const c=(null==n?void 0:n.displayHint)===s.ConsentExperienceType.Banner,u=(null==n?void 0:n.displayHint)===s.ConsentExperienceType.Modal;if(c?a=s.DisplayExperienceType.Banner:u&&(a=s.DisplayExperienceType.Modal),!a)return void console.error("experienceType is required in action.params");if(!i)return void console.error("experienceID is required in action.params");if("No Experience"===i||"noExperience"===i)return a===s.DisplayExperienceType.Modal&&"showConsent"!==o?void t.showConsentExperience({displayHint:s.ConsentExperienceType.Modal}):void r.default.debug(`experienceID is ${i} (set to not show any experience), returning`);const d=yield t.getFullConfig();if(!d)return void r.default.error("No configuration");if(!d.experiences)return void r.default.error("No experiences",{fullConfig:d});if(!d.experiences.ids)return void r.default.error("No experience ids",{fullConfig:d});if(!d.experiences.ids[i])return void r.default.error("No experience",{fullConfig:d,experienceID:i});d.experiences.ids[i].loadingMethod===s.ExperienceLoadingMethod.Dynamic&&d.experiences.ids[i].data;const l=d.experiences.ids[i];if(l){if(!l.content[a]||!l.layout[a]){if(a===s.DisplayExperienceType.Modal&&"showConsent"!==o)return void t.showConsentExperience({displayHint:s.ConsentExperienceType.Modal});r.default.warn("No data for experience type",{fullConfig:d,experienceID:i,experienceType:a})}switch(d.experiences.content[a]=l.content[a],d.experiences.content.display=a,d.experiences.content.static=l.content.static,d.experiences.layout[a]=l.layout[a],d.experiences.layout.entitlementInfo=l.layout.entitlementInfo,a===s.DisplayExperienceType.Preference?(d.experiences.autoInitiated.content=Object.assign(Object.assign({},d.experiences.autoInitiated.content),{[a]:l.content[a]}),d.experiences.autoInitiated.content.display=a,d.experiences.autoInitiated.content.static=l.content.static,d.experiences.autoInitiated.layout=Object.assign(Object.assign({},d.experiences.autoInitiated.layout),{[a]:l.layout[a]}),d.experiences.autoInitiated.layout.entitlementInfo=l.layout.entitlementInfo,d.experiences.userInitiated.content=Object.assign(Object.assign({},d.experiences.userInitiated.content),{[a]:l.content[a]}),d.experiences.userInitiated.content.display=a,d.experiences.userInitiated.content.static=l.content.static,d.experiences.userInitiated.layout=Object.assign(Object.assign({},d.experiences.userInitiated.layout),{[a]:l.layout[a]}),d.experiences.userInitiated.layout.entitlementInfo=l.layout.entitlementInfo):a!==s.DisplayExperienceType.Banner&&a!==s.DisplayExperienceType.Modal||(d.experiences.content[s.DisplayExperienceType.Banner]=l.content[s.DisplayExperienceType.Banner],d.experiences.content[s.DisplayExperienceType.Modal]=l.content[s.DisplayExperienceType.Modal],d.experiences.layout[s.DisplayExperienceType.Banner]=l.layout[s.DisplayExperienceType.Banner],d.experiences.layout[s.DisplayExperienceType.Modal]=l.layout[s.DisplayExperienceType.Modal],d.experiences.autoInitiated.content=Object.assign(Object.assign({},d.experiences.autoInitiated.content),{[s.DisplayExperienceType.Banner]:l.content[s.DisplayExperienceType.Banner],[s.DisplayExperienceType.Modal]:l.content[s.DisplayExperienceType.Modal]}),d.experiences.autoInitiated.content.display=a,d.experiences.autoInitiated.content.static=l.content.static,d.experiences.autoInitiated.layout=Object.assign(Object.assign({},d.experiences.autoInitiated.layout),{[s.DisplayExperienceType.Banner]:l.layout[s.DisplayExperienceType.Banner],[s.DisplayExperienceType.Modal]:l.layout[s.DisplayExperienceType.Modal]}),d.experiences.autoInitiated.layout.entitlementInfo=l.layout.entitlementInfo,d.experiences.userInitiated.content=Object.assign(Object.assign({},d.experiences.userInitiated.content),{[s.DisplayExperienceType.Banner]:l.content[s.DisplayExperienceType.Banner],[s.DisplayExperienceType.Modal]:l.content[s.DisplayExperienceType.Modal]}),d.experiences.userInitiated.content.display=a,d.experiences.userInitiated.content.static=l.content.static,d.experiences.userInitiated.layout=Object.assign(Object.assign({},d.experiences.userInitiated.layout),{[s.DisplayExperienceType.Banner]:l.layout[s.DisplayExperienceType.Banner],[s.DisplayExperienceType.Modal]:l.layout[s.DisplayExperienceType.Modal]}),d.experiences.userInitiated.layout.entitlementInfo=l.layout.entitlementInfo),o){case"showExperience":t._showExperience(n);break;case"showPreference":t._showPreferenceExperience(n);break;case"showConsent":t._showConsentExperience(n,a,e.options);break;default:t.renderExperience(a,n,e.options)}}else r.default.error("No experience data",{fullConfig:d,experienceID:i})}))},372:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsConfig=void 0;const i=n(1635),o=i.__importDefault(n(6092)),r=i.__importDefault(n(7931)),s=n(5305),a=n(436);t.TagsConfig=[{elementName:"script",purposesAttribute:"data-purposes",requiredAttributeValues:{type:"text/plain"},enableActions:{attributeValueSwaps:{type:"text/javascript"}}},{elementName:"iframe",purposesAttribute:"data-purposes",requiredAttributes:["data-src"],enableActions:{attributeNameSwaps:{"data-src":"src"}}},{elementName:"img",purposesAttribute:"data-purposes",requiredAttributes:["data-src"],enableActions:{attributeNameSwaps:{"data-src":"src"}}},{elementName:"link",purposesAttribute:"data-purposes",requiredAttributes:["data-href"],requiredAttributeValues:{rel:"prefetch"},enableActions:{attributeNameSwaps:{"data-href":"href"}}},{elementName:"link",purposesAttribute:"data-purposes",requiredAttributes:["data-href"],requiredAttributeValues:{rel:"preconnect"},enableActions:{attributeNameSwaps:{"data-href":"href"}}},{elementName:"link",purposesAttribute:"data-purposes",requiredAttributes:["data-href"],requiredAttributeValues:{rel:"dns-prefetch"},enableActions:{attributeNameSwaps:{"data-href":"href"}}},{elementName:"link",purposesAttribute:"data-purposes",requiredAttributes:["data-href"],requiredAttributeValues:{rel:"stylesheet"},enableActions:{attributeNameSwaps:{"data-href":"href"}}},{elementName:"script",purposesAttribute:"data-purposes-all",requiredAttributeValues:{type:"text/plain"},enableActions:{attributeValueSwaps:{type:"text/javascript"}},requireAllPurposes:!0},{elementName:"iframe",purposesAttribute:"data-purposes-all",requiredAttributes:["data-src"],enableActions:{attributeNameSwaps:{"data-src":"src"}},requireAllPurposes:!0}],t.default=class{constructor(e,t,n){this._results={},this.getMappedElements=(e,t,n,i,o=!1)=>{const a=(0,s.wrapLogger)(r.default,"tags: getMappedElements"),c=document.querySelectorAll(e),u=Array.from(c).filter((e=>{const r=!!t&&e.hasAttribute(t),s=o&&e.hasAttribute("data-ketch-id"),a=!n||(null==n?void 0:n.every((t=>e.hasAttribute(t)))),c=!i||Object.entries(i).every((([t,n])=>e.getAttribute(t)===n));return(r||s)&&a&&c}));return a.debug(`found ${u.length} '${e}' elements mapped to ketch purposes`),u},this.enableElement=(e,t={},n={})=>{let i;return(0,s.wrapLogger)(r.default,"tags: enableElement").debug("enabling element",e),Object.entries(t).forEach((([t,n])=>{const i=e.getAttribute(t);i&&(e.setAttribute(n,i),e.removeAttribute(t))})),Object.entries(n).forEach((([t,n])=>{var o;i=e.cloneNode(!0),i.setAttribute(t,n),null===(o=e.parentNode)||void 0===o||o.replaceChild(i,e)})),null!=i?i:e},this.getGrantedPurposes=()=>i.__awaiter(this,void 0,void 0,(function*(){const e=(0,s.wrapLogger)(r.default,"tags: getGrantedPurposes"),t=yield this._ketch.getConsent(),n=(null==t?void 0:t.purposes)||{};return e.debug("got consent purposes",n),new Set(Object.keys(n).filter((e=>!0===n[e])))})),this.getRequiredPurposes=(e,t,n=!1)=>{var i,o,a;const c=(0,s.wrapLogger)(r.default,"tags: getRequiredPurposes");if(n){const t=e.getAttribute("data-ketch-id")||"";return(null===(o=null===(i=this._config.tags)||void 0===i?void 0:i[t])||void 0===o?void 0:o.purposeCodes)||[]}return t?(null===(a=e.getAttribute(t))||void 0===a?void 0:a.split(" "))||[]:(c.error("No purposes attribute for element: ",e),[])},this.execute=()=>i.__awaiter(this,void 0,void 0,(function*(){const e=(0,s.wrapLogger)(r.default,"tags: execute"),t=yield this.getGrantedPurposes();return e.debug("granted purposes",t),this._tagsConfig.forEach((n=>i.__awaiter(this,void 0,void 0,(function*(){var i,o;const{elementName:r,purposesAttribute:s,requiredAttributes:a,requiredAttributeValues:c,enableActions:{attributeNameSwaps:u,attributeValueSwaps:d},isPlatformMapped:l,requireAllPurposes:p}=n,f=this.getMappedElements(r,s,a,c,l),_=f.filter((n=>{const i=this.getRequiredPurposes(n,s,l),o=l&&!i.length;e.debug("required purposes for element",n,i);const r=p?i.every((e=>t.has(e))):i.some((e=>t.has(e)));return!(!o&&!r||(this.enableElement(n,u,d),0))})),h=f.filter((e=>!this.getRequiredPurposes(e,s,l).some((e=>t.has(e))))),g=(null===(i=this._results[r])||void 0===i?void 0:i.enabledElements)||[],E=((null===(o=this._results[r])||void 0===o?void 0:o.disabledElements)||[]).filter((e=>!g.includes(e)&&!_.includes(e)));this._results[r]={enabledElements:[...g,..._],disabledElements:[...E.filter((e=>!h.includes(e))),...h]},e.debug(`enabled ${r} elements:`,_,`disabled ${r} elements:`,h)})))),(0,a.addToKetchLog)("getWrappedTags",(()=>{Object.entries(this._results).forEach((([e,{enabledElements:t,disabledElements:n}])=>{console.group(`%cWrapped %c<${e}>%c Tags`,"","font-family: monospace; background-color: #f4f4f4; padding: 2px 4px; border-radius: 3px; color: #333;",""),console.groupCollapsed(`%cBlocked (${n.length})`,"color: red"),n.forEach((e=>console.log(e))),console.groupEnd(),console.groupCollapsed(`%cAllowed (${t.length})`,"color: green"),t.forEach((e=>console.log(e))),console.groupEnd(),console.groupEnd()}))})),Object.values(this._results).reduce(((e,t)=>e.concat(t.enabledElements)),[])})),this._ketch=e,this._tagsConfig=t,this._config=n,this._ketch.on(o.default.CONSENT_EVENT,(()=>this.execute()))}}},532:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(8509),r=n(5305),s=i.__importDefault(n(7931)),a=i.__importDefault(n(5834)),c=n(4835),u=i.__importDefault(n(300)),d=n(4999);t.default=class{constructor(e,t){this._ketch=e,this._config=t,this._api=new d.KetchWebAPI((0,u.default)(this._config))}normalizeConsent(e,t){var n;if(!e.purposes)return e.purposes={},e;for(const i of Object.keys(e.purposes)){const o=e.purposes[i];"string"==typeof o&&(e.purposes[i]={allowed:o,legalBasisCode:null===(n=t.purposes[i])||void 0===n?void 0:n.legalBasisCode})}return e}enableAllConsent(){var e,t,n;return i.__awaiter(this,void 0,void 0,(function*(){const i=(0,r.wrapLogger)(s.default,"trackers: enableAllConsent");if(this._ketch.hasConsent())return i.trace("trackers: has consent"),this._ketch.getConsent();i.debug("trackers: obtaining and setting consent");const u=yield this._ketch.getIdentities();if(i.debug("trackers: identities",u),!u||0===Object.keys(u).length)throw a.default.noIdentitiesError;if(!(this._config&&this._config.property&&this._config.organization&&this._config.environment&&this._config.purposes&&this._config.jurisdiction&&0!==this._config.purposes.length))throw a.default.noPurposesError;const d={organizationCode:null!==(e=this._config.organization.code)&&void 0!==e?e:"",propertyCode:null!==(t=this._config.property.code)&&void 0!==t?t:"",environmentCode:this._config.environment.code,jurisdictionCode:null!==(n=this._config.jurisdiction.code)&&void 0!==n?n:"",identities:u,purposes:{}};for(const e of this._config.purposes)d.purposes[e.code]={legalBasisCode:e.legalBasisCode};i.debug("trackers: calling getConsent",d);const l=this.normalizeConsent(yield this._api.getConsent(d),d);i.debug("trackers: getConsent returned",l),yield(0,c.setCachedConsent)(l,this._config),yield(0,c.setPublicConsent)(l,this._config);const p={purposes:{}};if(null==l?void 0:l.purposes)for(const[e]of Object.entries(l.purposes))p.purposes[e]=!0;return l.vendors&&(p.vendors=l.vendors),l.googleVendors&&(p.googleVendors=l.googleVendors),l.protocols&&(p.protocols=l.protocols),i.debug("trackers: newConsent",p),yield this._ketch.setConsent(p,o.ConsentSource.Unknown,!0),p}))}}},8773:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boot=void 0;const i=n(1635),o=i.__importDefault(n(8347)),r=i.__importDefault(n(7931)),s=i.__importDefault(n(2774));t.boot=function(){return i.__awaiter(this,void 0,void 0,(function*(){window.semaphore=window.semaphore||[],window.ketch=window.ketch||s.default;const e=()=>i.__awaiter(this,void 0,void 0,(function*(){try{yield(0,o.default)()}catch(e){r.default.error(e)}}));"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,{once:!0}):yield e()}))}},4835:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCacheEntry=t.getCacheEntry=t.clearCacheEntry=t.setCachedNavNode=t.getCachedNavNode=t.getLanyardRoot=t.setPublicConsent=t.setCachedConsent=t.getCachedConsent=t.KEYBOARD_HANDLER_CACHE_KEYS=t.PUBLIC_CONSENT_TTL=t.CACHED_CONSENT_TTL=t.CACHED_PROTOCOLS_KEY=t.PUBLIC_CONSENT_KEY_V1=t.CACHED_CONSENT_KEY=void 0;const i=n(1635),o=n(9791),r=n(835),s=n(5305),a=i.__importDefault(n(7931)),c=n(6092),u=n(7296);t.CACHED_CONSENT_KEY="_swb_consent_",t.PUBLIC_CONSENT_KEY_V1="_ketch_consent_v1_",t.CACHED_PROTOCOLS_KEY="_swb_consent_",t.CACHED_CONSENT_TTL=300,t.PUBLIC_CONSENT_TTL=3456e4,t.KEYBOARD_HANDLER_CACHE_KEYS={CTX_KEY:"_ketch_currentKeyboardCtx",LANYARD_DOM:"_ketch_lanyardRootDom",FOCUSABLE_ELEMS:"_ketch_focusableElems",MODAL_STACKS:"_ketch_modalStacks",SUB_EXPERIENCE_CTX:"_ketch_subExperienceCtx"};const d=(0,o.getDefaultCacher)(),l=new o.WebStorageCacher(window.localStorage,86400);function p(e){return window&&window[e]||localStorage&&localStorage.getItem(e)}function f(e,t){localStorage&&(null===localStorage||void 0===localStorage||localStorage.setItem(e,t)),window&&(window[e]=t)}t.getCachedConsent=function(e,n){var o;return i.__awaiter(this,void 0,void 0,(function*(){const i={organizationCode:e.organizationCode,propertyCode:e.propertyCode,environmentCode:e.environmentCode,jurisdictionCode:e.jurisdictionCode,identities:e.identities,purposes:{},collectedAt:0};if(n.options&&"no-cache"===n.options["Cache-Control"])return i;if("IOS"===(null===(o=n.property)||void 0===o?void 0:o.platform))return i;const r=yield d.getItem(t.CACHED_CONSENT_KEY);if(!r)return i;if(0===Object.keys(r).length)return i;if(!r.collectedAt)return i;const s=r,a=yield l.getItem(t.CACHED_PROTOCOLS_KEY);return s.vendors=null==a?void 0:a.vendors,s.googleVendors=null==a?void 0:a.googleVendors,s.protocols=null==a?void 0:a.protocols,s.vendorConsents=null==a?void 0:a.vendorConsents,s}))},t.setCachedConsent=function(e,n){var o;return i.__awaiter(this,void 0,void 0,(function*(){if(!e||0===Object.keys(e).length)return;e.collectedAt=Math.floor(Date.now()/1e3);const i=Object.assign({},e);yield null==l?void 0:l.setItem(t.CACHED_PROTOCOLS_KEY,i),i.vendors=void 0,i.googleVendors=void 0,"vendorConsents"in i&&(i.vendorConsents=void 0),"protocols"in i&&(i.protocols=void 0),n.options&&"true"===n.options.cache_cookies_disabled||"IOS"!==(null===(o=n.property)||void 0===o?void 0:o.platform)&&(yield null==d?void 0:d.setItem(t.CACHED_CONSENT_KEY,i))}))},t.setPublicConsent=function(e,n){return i.__awaiter(this,void 0,void 0,(function*(){if(0===Object.keys(e).length)return;const i={};if(n.purposes){for(const t of n.purposes){if(!Object.prototype.hasOwnProperty.call(e.purposes,t.code))continue;const n=e.purposes[t.code];let o="";"string"==typeof n?o="true"===n?"granted":"denied":n.allowed&&(o="true"===n.allowed?"granted":"denied"),0!=o.length&&(i[t.code]={status:o},t.canonicalPurposeCodes?i[t.code].canonicalPurposes=t.canonicalPurposeCodes:t.canonicalPurposeCode&&t.canonicalPurposeCode.length>0&&(i[t.code].canonicalPurposes=[t.canonicalPurposeCode]))}if(Object.keys(i).length>0){const e=btoa(JSON.stringify(i));null===localStorage||void 0===localStorage||localStorage.setItem(t.PUBLIC_CONSENT_KEY_V1,e),n.options&&"true"===n.options.cache_cookies_disabled||(0,r.setCookie)(window,t.PUBLIC_CONSENT_KEY_V1,e,t.PUBLIC_CONSENT_TTL)}}}))},t.getLanyardRoot=function(){if(window&&window[t.KEYBOARD_HANDLER_CACHE_KEYS.LANYARD_DOM])return window[t.KEYBOARD_HANDLER_CACHE_KEYS.LANYARD_DOM];{const e=document.getElementById(c.LANYARD_ID);return window&&(window[t.KEYBOARD_HANDLER_CACHE_KEYS.LANYARD_DOM]=e),e}},t.getCachedNavNode=function(e,t={}){const n=(0,s.wrapLogger)(a.default,"getCachedDomNode");if(!window&&!localStorage)return n.debug("missing storage options"),null;const i=p(e);return i?(0,u.decodeDataNav)(i):(n.debug("cache missing key: ",e),t.ifNull?(n.debug("populating cache"),f(e,t.ifNull),(0,u.decodeDataNav)(t.ifNull)):null)},t.setCachedNavNode=function(e,t){const n=(0,s.wrapLogger)(a.default,"setCachedNavNode"),i=t.src;i?f(e,i):n.debug(`Missing data nav encoding. Cannot cache ${e}`)},t.clearCacheEntry=function(e){window&&(window[e]=void 0),localStorage&&localStorage.removeItem(e)},t.getCacheEntry=p,t.setCacheEntry=f},6092:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LANYARD_ID=t.EMPTY_CONSENT=t.ShowExperienceEvents=void 0,function(e){e.SHOW_CONSENT_EXPERIENCE_EVENT="showConsentExperience",e.SHOW_PREFERENCE_EXPERIENCE_EVENT="showPreferenceExperience",e.SHOW_PROGRESSIVE_EXPERIENCE_EVENT="showProgressiveExperience",e.SHOW_CONSENT_GATE_EXPERIENCE_EVENT="showConsentGateExperience",e.SHOW_EXPERIENCE_EVENT="showExperience",e.RENDER_EXPERIENCE_EVENT="renderExperience"}(n=t.ShowExperienceEvents||(t.ShowExperienceEvents={}));const i=Object.assign(Object.assign({},n),{CONSENT_EVENT:"consent",ENVIRONMENT_EVENT:"environment",FULFILLED_EVENT:"fulfilled",GEOIP_EVENT:"geoip",HANDLE_KEYBOARD_EVENT:"handleKeyboardEvent",HAS_CHANGED_EXPERIENCE_EVENT:"hasChangedExperience",HAS_SHOWN_EXPERIENCE_EVENT:"hasShownExperience",HIDE_EXPERIENCE_EVENT:"hideExperience",HIDE_EXPERIENCE_REASON_EVENT:"hideExperienceReasonUpdated",IDENTITIES_EVENT:"identities",IDENTITY_EVENT:"identity",USER_ATTRIBUTES_EVENT:"userAttributes",USER_ATTRIBUTE_EVENT:"userAttribute",PROFILE_EVENT:"profile",JURISDICTION_EVENT:"jurisdiction",PROTOCOLS_EVENT:"protocols",REGION_INFO_EVENT:"regionInfo",RETURN_KEYBOARD_CONTROL:"returnKeyboardControl",RIGHT_INVOKED_EVENT:"rightInvoked",SUBSCRIPTIONS_EVENT:"subscriptions",SUBSCRIPTION_CONFIG_EVENT:"subscriptionConfig",USER_CONSENT_UPDATED_EVENT:"userConsentUpdated",WILL_CHANGE_EXPERIENCE_EVENT:"willChangeExperience",WILL_SHOW_EXPERIENCE_EVENT:"willShowExperience",NEEDS_CONSENT_EVENT:"needsConsent"});t.default=Object.assign(Object.assign({},i),{NONE:"none",ENV:"env",PRODUCTION:"production",REGION:"region",JURISDICTION:"jurisdiction",LANGUAGE:"lang",SHOW:"show",PREFERENCES_TAB:"preferences_tab",PREFERENCES_TABS:"preferences_tabs",CONSENT:"cd",PREFERENCES:"preferences",CONSENT_GATE:"consentGate",API_SERVER:"shoreline",API_SERVER_BASE_URL:"https://global.ketchcdn.com/web/v2",EXPERIENCE_VERSION:"experience_version",EXPERIENCE_RULES_VERSION:"experience_rules_version",NO_CACHE:"no_cache",ROUTER_ACCEPT_ALL_CONSENT_FLAG:"router_accept_all_consent_flag",ROUTER_REJECT_ALL_CONSENT_FLAG:"router_reject_all_consent_flag",EMULATOR_OVERRIDE_CONSENT:"overrideConsent"}),t.EMPTY_CONSENT={purposes:{},vendors:[],googleVendors:[],protocols:{}},t.LANYARD_ID="lanyard_root"},192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return window.dataLayer=window.dataLayer||[]}},5834:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={actionNotFoundError:e=>new Error(`action "${e}" not found`),expectedFunctionError:e=>new Error(`action "${e}" expected a function`),unrecognizedLocationError:new Error("unrecognized location"),noIdentitiesError:new Error("no identities"),noPurposesError:new Error("no purposes"),noEnvironmentError:new Error("no environment"),noJurisdictionError:new Error("no jurisdiction"),invalidConfigurationError:new Error("invalid configuration"),emptyConsentError:new Error("empty consent")}},300:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=i.__importDefault(n(6092)),r=i.__importDefault(n(3449));t.default=function(e){if(e.services){let t=e.services[o.default.API_SERVER];t.endsWith("/")&&(t=t.slice(0,-1));const n=r.default.get(o.default.EXPERIENCE_VERSION);return n&&(t.includes("v3")&&"old"===n?t=t.replace("v3","v2"):t.includes("v2")&&"new"===n&&(t=t.replace("v2","v3"))),t.endsWith("/web/v2")||t.endsWith("/web/v3")||(t+="/web/v2"),t}return o.default.API_SERVER_BASE_URL}},549:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ketch=t.boot=void 0;const i=n(5926);Object.defineProperty(t,"Ketch",{enumerable:!0,get:function(){return i.Ketch}});const o=n(8773);Object.defineProperty(t,"boot",{enumerable:!0,get:function(){return o.boot}})},8347:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=i.__importDefault(n(7931)),r=i.__importDefault(n(5250)),s=i.__importDefault(n(3004)),a=i.__importDefault(n(532)),c=i.__importStar(n(372)),u=i.__importDefault(n(2433)),d=i.__importDefault(n(6092)),l=n(6122),p=n(8509);t.default=function(){var e,t;return i.__awaiter(this,void 0,void 0,(function*(){const n=window.semaphore||[],i=n.shift();if(!Array.isArray(i)||2!=i.length||"init"!=i[0])throw Error("ketch tag command queue is not configured correctly");const f=i[1];o.default.debug("init",f);const _=new r.default(f),h=yield _.build(),g=new s.default(h);for(;n.length>0;)g.push(n.shift());window.semaphore.push=g.push.bind(g),window.semaphore.loaded=!0;const E="true"===sessionStorage.getItem(d.default.ROUTER_ACCEPT_ALL_CONSENT_FLAG),v="true"===sessionStorage.getItem(d.default.ROUTER_REJECT_ALL_CONSENT_FLAG);if(E)return o.default.debug("hasRouterAcceptAllFlag is set, skipping getConsent"),yield h.acceptAllConsent(),void sessionStorage.removeItem(d.default.ROUTER_ACCEPT_ALL_CONSENT_FLAG);if(v)return o.default.debug("hasRouterRejectAllFlag is set, skipping getConsent"),yield h.rejectAllConsent(),void sessionStorage.removeItem(d.default.ROUTER_REJECT_ALL_CONSENT_FLAG);const y=yield h.getConfig();if((null===(e=y.deployment)||void 0===e?void 0:e.isOrchestrationOnly)||(null==y?void 0:y.isConfigPaused))o.default.debug("exiting early, config is paused or orchestration only");else{if(h.getAreRulesEnabled())(0,l.evaluateRules)(p.RuleTrigger.ON_LOAD,(null===(t=y.rules)||void 0===t?void 0:t[p.RuleTrigger.ON_LOAD])||[],h);else if("true"===(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(d.default.EMULATOR_OVERRIDE_CONSENT))){const e=new a.default(h,y);yield e.enableAllConsent()}else yield h.getConsent();new c.default(h,c.TagsConfig,y).execute(),new u.default(h,y).execute()}}))}},3044:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}},8705:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},2774:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,...t){(window.semaphore=window.semaphore||[]).push([e,...t])}},7262:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleNavigation=t.navigateBannerTree=t.getBannerTree=t.navigateModalStacks=t.handleDisabledSwitches=t.getModalStacks=t.getStaticModalNodes=t.handleSelection=t.handleSubExperienceCaching=t.renderNavigation=t.clearCachedNodes=t.getArrowActionFromUserAgent=t.getUserAgent=void 0;const i=n(1635),o=n(5305),r=n(4835),s=n(9305),a=i.__importDefault(n(7931)),c=n(7296);t.getUserAgent=()=>{const e=(0,o.wrapLogger)(a.default,"getUserAgent"),t=navigator.userAgent.toUpperCase();return Object.values(s.SupportedUserAgents).find((e=>-1!==t.search(e)))||void e.debug(`Unsupported userAgent: ${t}`)},t.getArrowActionFromUserAgent=e=>{const n=(0,o.wrapLogger)(a.default,"getArrowActionFromUserAgent"),i=(0,t.getUserAgent)();if(!i)return n.debug(`Unknown userAgent: ${navigator.userAgent}`),s.ArrowActions.UNKNOWN;const r=s.UserAgentHandlerMap[i];return r?r[e.keyCode]?r[e.keyCode]:(n.debug(`Unknown key: ${e.keyCode}`),s.ArrowActions.UNKNOWN):(n.debug(`Misconfigured userAgent: ${i}`),s.ArrowActions.UNKNOWN)},t.clearCachedNodes=()=>{const e=(0,o.wrapLogger)(a.default,"clearCachedNodes");Object.values(r.KEYBOARD_HANDLER_CACHE_KEYS).forEach((t=>{e.trace(`clearing ${t}`),(0,r.clearCacheEntry)(t)}))},t.renderNavigation=e=>{const t=(0,o.wrapLogger)(a.default,"renderNavigation"),n=(0,r.getLanyardRoot)();if(!n)return void t.debug("missing lanyard root");const{prev:i,next:s}=e;if(i){const e=n.querySelector(`[data-nav="${i.src}"]`);e?e.blur():t.debug(`node not found: ${i.src} -- ${i["nav-index"]}`)}if(s){const e=n.querySelector(`[data-nav="${s.src}"]`);e?e.focus():t.debug(`node not found: ${s.src} -- ${s["nav-index"]}`)}},t.handleSubExperienceCaching=(e,t)=>{const n=(0,r.getCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX);if(n||e.action!==s.LanyardItemActions.expand){if(e.action===s.LanyardItemActions.expand&&n===e.subExperience)(0,r.clearCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX);else if(e.action===s.LanyardItemActions.switch&&n===e.subExperience){const e=t.find((e=>e.subExperience===n&&e.action===s.LanyardItemActions.expand)),i=e&&(0,c.getDomNode)(e);i&&"function"==typeof i.click&&i.click(),(0,r.clearCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX)}else if(n!==e.subExperience&&e.action===s.LanyardItemActions.expand){const i=t.find((e=>e.subExperience===n&&e.action===s.LanyardItemActions.expand)),o=i&&(0,c.getDomNode)(i);o&&"function"==typeof o.click&&o.click(),(0,r.setCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX,e.subExperience)}}else(0,r.setCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX,e.subExperience)},t.handleSelection=(e=!0,n)=>{const i=(0,o.wrapLogger)(a.default,"handleSelection"),s=(0,r.getCachedNavNode)(r.KEYBOARD_HANDLER_CACHE_KEYS.CTX_KEY),u=(0,c.getDomNode)(s);s&&u&&"function"==typeof u.click?(e&&(0,t.clearCachedNodes)(),Array.isArray(n)&&s.subExperience&&(0,t.handleSubExperienceCaching)(s,n),u.click()):i.debug("Node missing or missing click fn",u)},t.getStaticModalNodes=e=>{const t=(0,o.wrapLogger)(a.default,"getStaticModalNodes");if(0===e.length)return t.debug("no clickable nodes"),{topNodes:[]};const n=(0,c.safeJsonParse)((0,r.getCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.MODAL_STACKS));if(n&&Array.isArray(n.topNodes))return n;const i=e.filter((e=>void 0===e.subExperience)).sort(((e,t)=>e["nav-index"]-t["nav-index"]));t.trace("top nodes:",i);const u=e.filter((e=>e.subExperience&&e.action===s.LanyardItemActions.expand)).sort(((e,t)=>void 0===e.subExperience||void 0===t.subExperience?0:e.subExperience.localeCompare(t.subExperience)));t.trace("expand nodes:",u);const d=e.filter((e=>e.subExperience&&e.action===s.LanyardItemActions.switch)).sort(((e,t)=>void 0===e.subExperience||void 0===t.subExperience?0:e.subExperience.localeCompare(t.subExperience)));t.trace("switch nodes:",d);const l={expandNodes:u.length>0?u:void 0,switchNodes:d.length>0?d:void 0,topNodes:i};return(0,r.setCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.MODAL_STACKS,JSON.stringify(l)),l},t.getModalStacks=e=>{const n=(0,o.wrapLogger)(a.default,"getModalStacks"),i=(0,t.getStaticModalNodes)(e);Array.isArray(i.topNodes)&&0!==i.topNodes.length||n.debug("Missing top nodes in the stack");const s=(0,r.getCacheEntry)(r.KEYBOARD_HANDLER_CACHE_KEYS.SUB_EXPERIENCE_CTX);if(s){if(n.trace("existing subExperienceCtx:",s),!i.expandNodes||0===i.expandNodes.length)return n.debug(`missing expand nodes for ${s}. Returning without subExperience`),i;const t=e.filter((e=>e.subExperience===s)).sort(((e,t)=>e["nav-index"]-t["nav-index"]));n.trace(`found ${t.length} nodes in ${s}`);const o=i.expandNodes.findIndex((e=>e.subExperience===s));if(-1===o)return n.debug(`Expand nodes missing for ${s}. Returning stacks without subExperience`),i;i.expandNodes=[...i.expandNodes.slice(0,o),...t,...i.expandNodes.slice(o+1)],n.trace("updating expand nodes",i.expandNodes)}return i},t.handleDisabledSwitches=(e,t)=>{if(e.action===s.LanyardItemActions.switch&&e.disabled){const n=null==t?void 0:t.find((t=>t.subExperience===e.subExperience));if(n)return n}return e},t.navigateModalStacks=(e,n,i)=>{var c,u,d;const l=(0,o.wrapLogger)(a.default,"navigateModalStacks");if(!e||!e.topNodes||!(null===(c=e.topNodes)||void 0===c?void 0:c.length))return l.debug("no top nodes found in the modal"),null;if(null===i)return l.debug(`Defaulting first selection to node: ${e.topNodes[0]}`),e.topNodes[0];const p=i.action,f=p===s.LanyardItemActions.switch?e.switchNodes:p===s.LanyardItemActions.expand||i.subExperience?e.expandNodes:e.topNodes;if(!f)return l.debug("Storage inconsistent"),null;l.trace("activeStack:",f);const _=f.findIndex((e=>e.src===i.src));l.trace(`moving ${n} from index ${_}`);let h=null;switch(n){case s.ArrowActions.UP:if(0===_){if(p===s.LanyardItemActions.expand||p===s.LanyardItemActions.switch){h=e.topNodes[e.topNodes.length-1];break}{const t=e.switchNodes||e.expandNodes;h=t&&t.length>0?t[t.length-1]:null;break}}h=f[_-1];break;case s.ArrowActions.DOWN:if(_===f.length-1){if(p===s.LanyardItemActions.expand||p===s.LanyardItemActions.switch){h=e.topNodes[0];break}{const t=e.switchNodes||e.expandNodes;h=t&&t.length>0?t[0]:null;break}}h=f[_+1];break;case s.ArrowActions.LEFT:p===s.LanyardItemActions.switch&&(h=null===(u=e.expandNodes)||void 0===u?void 0:u.find((e=>e.subExperience===i.subExperience)));break;case s.ArrowActions.RIGHT:p===s.LanyardItemActions.expand&&(h=null===(d=e.switchNodes)||void 0===d?void 0:d.find((e=>e.subExperience===i.subExperience)));break;case s.ArrowActions.OK:const n=i.action===s.LanyardItemActions.confirm||i.action===s.LanyardItemActions.close||i.action===s.LanyardItemActions.back||Boolean(i.clearCache);(0,t.handleSelection)(n,e.expandNodes);break;case s.ArrowActions.BACK:const o=e.topNodes.find((e=>e.action===s.LanyardItemActions.back));o&&((0,r.setCachedNavNode)(r.KEYBOARD_HANDLER_CACHE_KEYS.CTX_KEY,o),(0,t.handleSelection)(!0));break;default:return null}return h?(0,t.handleDisabledSwitches)(h,e.expandNodes):null},t.getBannerTree=e=>{const t=(0,o.wrapLogger)(a.default,"getBannerTree");if(0===e.length)return t.debug("no clickable nodes"),[];const n=e.sort(((e,t)=>e["nav-index"]-t["nav-index"]));return t.debug(n),n},t.navigateBannerTree=(e,n,i)=>{const r=(0,o.wrapLogger)(a.default,"navigateBannerTree");if(null===i)return r.debug(`Defaulting first selection to node: ${e[0]}`),e[0];const c=e.findIndex((e=>e.src===i.src));switch(r.debug("Starting at: ",c),n){case s.ArrowActions.UP:case s.ArrowActions.LEFT:return 0===c?(r.debug("Cannot move past last node"),null):e[c-1];case s.ArrowActions.RIGHT:case s.ArrowActions.DOWN:return c===e.length-1?(r.debug("Cannot move beyond first node"),null):e[c+1];case s.ArrowActions.OK:return(0,t.handleSelection)(!0),null;case s.ArrowActions.BACK:return r.trace("cannot back out of banner"),null;default:return r.debug("Unknown arrowAction: ",n),null}},t.handleNavigation=e=>{const n=(0,o.wrapLogger)(a.default,"handleNavigation");n.debug("Navigating ",e);const i=(0,r.getLanyardRoot)();if(null===i)return n.debug("Cannot find lanyard root"),null;if(!(i instanceof HTMLElement))return n.debug("Storage inconsistent"),null;const u=i.querySelectorAll("[data-nav]");if(!u||0===u.length)return n.debug("No tagged DOM nodes found"),null;const d=[];u.forEach((e=>{const t=(0,c.decodeDataNav)(e.dataset.nav||"");null!==t&&d.push(t)})),d.length!==u.length?n.debug("inconsistent encoding of data-nav"):window.decodedNodes=d;let l=null;const p=d[0].experience,f=(0,r.getCachedNavNode)(r.KEYBOARD_HANDLER_CACHE_KEYS.CTX_KEY);if(p===s.EXPERIENCES.BANNER){const n=(0,t.getBannerTree)(d);l=(0,t.navigateBannerTree)(n,e,f)}else if(p===s.EXPERIENCES.MODAL){const n=(0,t.getModalStacks)(d);l=(0,t.navigateModalStacks)(n,e,f)}else n.debug(`unhandled experience ${p}`);return l&&(n.debug("Updating cached context node: ",l),(0,r.setCachedNavNode)(r.KEYBOARD_HANDLER_CACHE_KEYS.CTX_KEY,l)),{prev:f,next:l}},t.default=function(e,n){const i=(0,o.wrapLogger)(a.default,"onKeyPress"),r="string"==typeof e?e:(0,t.getArrowActionFromUserAgent)(e);if(i.debug("Processing movement: ",r),r===s.ArrowActions.UNKNOWN){const o="string"==typeof e?e:e.keyCode;i.error(`Unknown input: ${o}`),i.debug("returning keyboard control"),(0,t.clearCachedNodes)(),n()}else{const e=(0,t.handleNavigation)(r);e?(0,t.renderNavigation)(e):(i.debug("returning keyboard control"),(0,t.clearCachedNodes)(),n())}}},9305:(e,t)=>{"use strict";var n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.UserAgentHandlerMap=t.SupportedUserAgents=t.LanyardItemActions=t.EXPERIENCES=t.ArrowActions=void 0,function(e){e.LEFT="LEFT",e.RIGHT="RIGHT",e.UP="UP",e.DOWN="DOWN",e.BACK="BACK",e.OK="OK",e.UNKNOWN="UNKNOWN"}(n=t.ArrowActions||(t.ArrowActions={})),t.EXPERIENCES={BANNER:"ketch-consent-banner",MODAL:"ketch-purpose-modal",PREFERENCES:"ketch-preferences",CONSENT_GATE:"ketch-consent-gate"},(o=t.LanyardItemActions||(t.LanyardItemActions={})).back="back",o.close="close",o.confirm="confirm",o.expand="expand",o.switch="switch",function(e){e.TIZEN="TIZEN",e.MACINTOSH="MACINTOSH"}(i=t.SupportedUserAgents||(t.SupportedUserAgents={}));const r={37:n.LEFT,38:n.UP,39:n.RIGHT,40:n.DOWN,13:n.OK,10009:n.BACK},s={37:n.LEFT,38:n.UP,39:n.RIGHT,40:n.DOWN,13:n.OK,27:n.BACK};t.UserAgentHandlerMap={[i.TIZEN]:r,[i.MACINTOSH]:s}},7931:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5305);let o=(0,i.getLogLevel)((0,i.getParams)(window.location.search,["ketch_","swb_"]));t.default=(0,i.getLogger)("ketch",o)},3449:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=(0,n(5305).getParams)(window.location.search,["ketch_","swb_"]);t.default=i},838:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gpcPlugin=void 0;const i=n(1635),o=n(835),r=n(5305),s=n(8509),a=i.__importDefault(n(7931)),c="gpcsignal";t.gpcPlugin={fn:(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){var n,i;const s=(0,r.wrapLogger)(a.default,"gpcPlugin"),u=yield e.getFullConfig();let d=!1;if(!(null===(n=u.jurisdiction)||void 0===n?void 0:n.code)||!u.plugins||!u.plugins.gpc)return s.debug("missing jurisdiction or plugin configuration, skipping"),[t,d];const l=u.plugins.gpc;if(!l.jurisdictions||!l.purposeMappings||!l.jurisdictions.includes(u.jurisdiction.code))return s.debug("invalid plugin configuration, skipping"),[t,d];const p=structuredClone(t),f=!0===(null===(i=null===window||void 0===window?void 0:window.navigator)||void 0===i?void 0:i.globalPrivacyControl),_="true"===(0,o.getCookie)(window,c);return _!==f&&((0,o.setCookie)(window,c,f,2592e3),s.debug("setting gpc signal cookie",f)),f&&!_&&(s.debug("gpc signal is true and existingGpcSignal is false"),p.isGpcEnabled=!0,l.purposeMappings.forEach((e=>{"gpc"===e.pluginPurposeID&&e.purposes&&e.purposes.forEach((e=>{var t;(null===(t=null==u?void 0:u.purposes)||void 0===t?void 0:t.some((t=>t.code===e&&t.allowsOptOut)))&&(p.purposes[e]=!1,d=!0)}))}))),s.debug("provisionalConsent",structuredClone(p)),[p,d]})),source:s.ConsentSource.GpcPlugins}},2186:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onetrustPlugin=t.readOneTrustConsentCookie=void 0;const i=n(1635),o=n(8509),r=n(5305),s=i.__importDefault(n(9207)),a=i.__importDefault(n(7931)),c=n(7893);t.readOneTrustConsentCookie=()=>{const e=(0,r.wrapLogger)(a.default,"readOTConsentCookie");try{const t=document.cookie.split(";").filter((e=>e.trim().startsWith("OptanonConsent")));if(0===t.length)return e.debug("OptanonConsent cookie not found"),{};e.debug(`Found ${t.length} OptanonConsent cookie(s)`);const n=t.reduce(((e,t)=>{const n=t.split("=").slice(1).join("="),i=new URLSearchParams(n),o=i.get("groups");return o&&e.push({cookie:t,cookieValue:n,params:i,domain:i.get("domain"),datestamp:i.get("datestamp"),groups:o}),e}),[]);if(0===n.length)return e.debug("No OptanonConsent cookies found with groups parameter"),{};const i=window.location.hostname,o=e=>{if(!e)return null;const t=e.split(".");return t.length<2?e:t.slice(-2).join(".")},r=e=>!!e&&o(i)===o(e),s=t=>{if(!t)return null;try{const e=decodeURIComponent(t).replace(/\+/g," ");return new Date(e)}catch(n){return e.debug("Failed to parse datestamp:",t,n),null}},a=n.filter((e=>r(e.domain)));let c;a.length>0?(e.debug(`Found ${a.length} domain-matching cookie(s)`),c=a.reduce(((e,t)=>{const n=s(e.datestamp),i=s(t.datestamp);return n||i?n?i&&i>n?t:e:t:e}))):(e.debug("No domain-matching cookies found, selecting most recent cookie"),c=n.reduce(((e,t)=>{const n=s(e.datestamp),i=s(t.datestamp);return n||i?n?i&&i>n?t:e:t:e}))),e.debug("Selected OptanonConsent cookie:",c.cookie),e.debug("Selected cookie domain:",c.domain),e.debug("Selected cookie datestamp:",c.datestamp);const u=c.groups;if(!u)return e.debug("groups parameter not found in selected OptanonConsent cookie"),{};e.debug("groups parameter found:",u);const d=decodeURIComponent(u),l={};return d.split(",").reduce(((e,t)=>{const[n,i]=t.split(":");return n&&void 0!==i&&(e[n]="1"===i),e}),l),l}catch(t){return e.error("Error parsing OptanonConsent cookie:",t),{}}};const u=(e,t,n,i,o=!1)=>{const s=(0,r.wrapLogger)(a.default,"applyOneTrustConsent"),c=Object.assign({},e);return i.forEach((i=>{const r=i.pluginPurposeID,a=i.purposes;s.debug("otConsentGroup",r),s.debug("ketchPurposeCodes",a),r&&r in t&&(null==a?void 0:a.length)&&a.forEach((i=>{var a;s.debug("processing purpose:",i);const u=null===(a=null==n?void 0:n.purposes)||void 0===a?void 0:a.find((e=>e.code===i));if(!u)return void s.debug("ketchPurpose not found in config",i);const d=e.purposes[i],l=t[r];u.allowsOptOut||!1!==l?void 0===d||o?(c.purposes[i]=l,s.debug("migrating consent for purpose",i,"setting to",l)):s.debug("skipping migration for purpose",i,"because it already has consent with value:",d):s.debug("ketchPurpose does not allow opt out and otConsentValue is false",i)}))})),c};t.onetrustPlugin={fn:(e,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){var i,d;const l=(0,r.wrapLogger)(a.default,"onetrustPlugin"),p=yield e.getFullConfig(),f=structuredClone(n),_=null===(i=p.plugins)||void 0===i?void 0:i.onetrust;if(!_)return l.debug("onetrust plugin options not found, skipping"),[f,!1];const h=null==_?void 0:_.purposeMappings;if(!h)return l.debug("onetrust plugin purpose mappings not found, skipping"),[f,!1];const g={};h.forEach((e=>{var t;null===(t=e.purposes)||void 0===t||t.forEach((t=>{g[t]=e.pluginPurposeID}))}));const E=(0,t.readOneTrustConsentCookie)();l.debug("otConsent",E),l.debug("ketch consent",Object.assign(Object.assign({},n),{purposes:Object.assign({},n.purposes)}));const v=u(n,E,p,h);return window.OptanonWrapper=()=>{var i;null===(i=window.OneTrust)||void 0===i||i.OnConsentChanged((()=>{l.debug("OneTrust.OnConsentChanged triggered");const i=(0,t.readOneTrustConsentCookie)();l.debug("newOtConsent",i),l.debug("ketch consent",Object.assign(Object.assign({},n),{purposes:Object.assign({},n.purposes)}));const r=u(n,i,p,h,!0);l.debug("After OT consent event - provisionalConsent.purposes keys:",r.purposes),e.setConsent(r,o.ConsentSource.OneTrustMigrator,!1)}))},(null===(d=null==p?void 0:p.purposes)||void 0===d?void 0:d.every((e=>(null==e?void 0:e.code)&&void 0!==g[e.code]&&void 0!==E[g[e.code]])))?(l.debug("all purposes set by OT, updating profile.consent.needsConsent"),yield e.setProfile(c.ProfileSection.CONSENT_NEEDS_CONSENT,!1),e.needsConsent=!1):l.debug("not all purposes set by OT, not updating profile.consent.needsConsent"),[v,!(0,s.default)(f,v)]})),source:o.ConsentSource.OneTrustMigrator}},7296:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.santizePaths=t.getDomNode=t.decodeDataNav=t.safeJsonParse=void 0;const i=n(1635),o=n(5305),r=i.__importDefault(n(7931)),s=n(4835);function a(e){const t=(0,o.wrapLogger)(r.default,"safeJsonParse");if(!e||""===e.trim())return{};try{return JSON.parse(e)}catch(n){return t.error(`Could not parse JSON for ${e} - ${n}`),null}}t.safeJsonParse=a,t.decodeDataNav=function(e){const t=(0,o.wrapLogger)(r.default,"decodeDataNav");let n="";try{n=window.atob(e)}catch(n){return t.debug(`Invalid encoding: ${e}`,n),null}const i=a(n);return"[object Object]"!==Object.prototype.toString.call(i)?null:(i.src=e,i)},t.getDomNode=function(e){const t=(0,o.wrapLogger)(r.default,"convertToKetchHTMLElement");if(!e||!e.src)return t.debug("node missing src",e),null;const n=`[data-nav="${e.src}"]`,i=(0,s.getLanyardRoot)();return i?i.querySelector(n):(t.debug("missing lanyard root"),null)},t.santizePaths=function(e){const t=(0,o.wrapLogger)(r.default,"santizePaths"),n=e.replace(/[^a-zA-Z0-9_-]/g,"");return n!==e&&t.debug(`path element "${e}" sanitized to "${n}"`),n}},4999:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KetchWebAPI=void 0;const i=n(1635);class o{constructor(e,t){this._baseUrl=e,this._fetch=t||n.g.fetch.bind(window)}getLocation(){return i.__awaiter(this,void 0,void 0,(function*(){return yield this.get("/ip")}))}getBootstrapConfiguration(e){return i.__awaiter(this,void 0,void 0,(function*(){return yield this.get(`/config/${e.organizationCode}/${e.propertyCode}/boot.json`)}))}getFullConfiguration(e){return i.__awaiter(this,void 0,void 0,(function*(){let t="";return this._baseUrl.includes("web/v3")?(e.environmentCode&&e.jurisdictionCode&&e.languageCode&&(t=`/${e.environmentCode}/${e.jurisdictionCode}/${e.languageCode}`),yield this.get(`/config/${e.organizationCode}/${e.propertyCode}${t}/config.json${e.hash?`?hash=${e.hash}`:""}`)):(e.environmentCode&&e.hash&&e.jurisdictionCode&&e.languageCode&&(t=`/${e.environmentCode}/${e.hash}/${e.jurisdictionCode}/${e.languageCode}`),yield this.get(`/config/${e.organizationCode}/${e.propertyCode}${t}/config.json`))}))}getSubscriptionsConfiguration(e){return i.__awaiter(this,void 0,void 0,(function*(){const{organizationCode:t,propertyCode:n,languageCode:i,experienceCode:o}=e;return yield this.get(`/config/${t}/${n}/${i}/${o}/subscriptions.json`)}))}getConsent(e){return i.__awaiter(this,void 0,void 0,(function*(){try{const t=yield this.post(`/consent/${e.organizationCode}/get`,e);return t&&t.purposes&&Object.keys(t.purposes).length?t:e}catch(t){return e}}))}getProtocols(e){return i.__awaiter(this,void 0,void 0,(function*(){try{const t=yield this.post(`/consent/${e.organizationCode}/get`,e);return t&&t.protocols&&Object.keys(t.protocols).length?Object.assign(Object.assign({},e),{protocols:t.protocols}):e}catch(t){return e}}))}setConsent(e){return i.__awaiter(this,void 0,void 0,(function*(){try{const t=yield this.post(`/consent/${e.organizationCode}/update`,e);return t&&t.purposes&&Object.keys(t.purposes).length?t:e}catch(t){return e}}))}getSubscriptions(e){return i.__awaiter(this,void 0,void 0,(function*(){return yield this.post(`/subscriptions/${e.organizationCode}/get`,e)}))}setSubscriptions(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.post(`/subscriptions/${e.organizationCode}/update`,e)}))}invokeRight(e){return i.__awaiter(this,void 0,void 0,(function*(){return this.post(`/rights/${e.organizationCode}/invoke`,e)}))}preferenceQR(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=new URL(`${this._baseUrl}/qr/${e.organizationCode}/${e.propertyCode}/preferences.png`);return e.environmentCode&&t.searchParams.set("env",e.environmentCode),e.imageSize&&t.searchParams.set("size",e.imageSize.toString()),e.path&&t.searchParams.set("path",e.path),e.backgroundColor&&t.searchParams.set("bgcolor",e.backgroundColor),e.foregroundColor&&t.searchParams.set("fgcolor",e.foregroundColor),Object.keys(e.parameters).forEach((n=>{t.searchParams.set(n,e.parameters[n])})),t.toString()}))}webReport(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this.post(`/report/${e}`,t)}))}get(e){return i.__awaiter(this,void 0,void 0,(function*(){return this._fetch(this._baseUrl+e,o.fetchOptions("GET")).then((e=>e.json()))}))}post(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n=yield this._fetch(this._baseUrl+e,o.fetchOptions("POST",t));if(!n.ok)throw new Error(yield n.text());return n.json()}))}static fetchOptions(e,t){const n={method:e,mode:"cors",credentials:"omit"},i="application/json";return t?(n.body=JSON.stringify(t),n.headers={Accept:i,"Content-Type":i}):n.headers={Accept:i},n}}t.KetchWebAPI=o},3165:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.map((e=>{try{return window.atob(decodeURIComponent(e))}catch(t){return e}}))}},5962:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encoding=void 0;const i=n(1635).__importDefault(n(3165));t.encoding=i.default},4080:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(4615),r=i.__importDefault(n(7029));t.default=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];const n=(0,o.getCookie)(e,t);return n&&"0"!==n?[n]:(0,r.default)(e,`ketch_${t}`)}))}},7111:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=t.fetcher=void 0;const i=n(1635).__importDefault(n(4080));t.fetcher=i.default;const o=n(4615);Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return o.getCookie}}),Object.defineProperty(t,"setCookie",{enumerable:!0,get:function(){return o.setCookie}})},4615:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=void 0;const i=n(835);Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return i.getCookie}}),t.setCookie=function(e,t,n,o){(0,i.setCookie)(e,t,n,o?86400*o:o)}},725:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);t.default=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(!e||!e.dataLayer||0===t.length)return[];let n=[];for(const i of e.dataLayer)if(Object.prototype.hasOwnProperty.call(i,t)){const e=i[t];e&&"0"!==e&&(n=n.concat(e))}return n}))}},2302:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(725));t.fetcher=i.default},9220:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.semicolonStructure=t.queryStructure=t.jwtStructure=t.jsonStructure=t.stringStructure=t.managedFetcher=t.queryStringFetcher=t.sessionStorageFetcher=t.localStorageFetcher=t.windowFetcher=t.dataLayerFetcher=t.setCookie=t.getCookie=t.cookieFetcher=void 0;const i=n(1635),o=n(7111);Object.defineProperty(t,"cookieFetcher",{enumerable:!0,get:function(){return o.fetcher}}),Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return o.getCookie}}),Object.defineProperty(t,"setCookie",{enumerable:!0,get:function(){return o.setCookie}});const r=n(2302);Object.defineProperty(t,"dataLayerFetcher",{enumerable:!0,get:function(){return r.fetcher}});const s=n(3841);Object.defineProperty(t,"windowFetcher",{enumerable:!0,get:function(){return s.fetcher}});const a=n(3861);Object.defineProperty(t,"localStorageFetcher",{enumerable:!0,get:function(){return a.fetcher}});const c=n(6944);Object.defineProperty(t,"sessionStorageFetcher",{enumerable:!0,get:function(){return c.fetcher}});const u=n(4334);Object.defineProperty(t,"queryStringFetcher",{enumerable:!0,get:function(){return u.fetcher}});const d=n(9694);Object.defineProperty(t,"managedFetcher",{enumerable:!0,get:function(){return d.fetcher}});const l=n(164);Object.defineProperty(t,"stringStructure",{enumerable:!0,get:function(){return l.structure}});const p=n(659);Object.defineProperty(t,"jsonStructure",{enumerable:!0,get:function(){return p.structure}});const f=n(7510);Object.defineProperty(t,"jwtStructure",{enumerable:!0,get:function(){return f.structure}});const _=n(4334);Object.defineProperty(t,"queryStructure",{enumerable:!0,get:function(){return _.structure}});const h=n(4774);Object.defineProperty(t,"semicolonStructure",{enumerable:!0,get:function(){return h.structure}});const g=i.__importDefault(n(1031));t.default=g.default},659:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const i=n(1635).__importDefault(n(5062));t.structure=i.default},5062:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("object"==typeof e&&!Array.isArray(e)&&null!==e)return e;const t=JSON.parse(e);return"object"!=typeof t||Array.isArray(t)||null===t?{value:t}:t}},7510:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const i=n(1635).__importDefault(n(2971));t.structure=i.default},2971:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.split(".")[1],n=atob(t);return JSON.parse(n)}},206:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6590);t.default=(0,i.fetcher)("localStorage")},3861:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(206));t.fetcher=i.default},9573:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(835),r=n(2831);t.default=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];t="_swb";let n=(0,o.getCookie)(e,t);return n?[n]:((0,o.setCookie)(e,t,(0,r.v4)(),63072e3),n=(0,o.getCookie)(e,t),n?[n]:[])}))}},9694:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(9573));t.fetcher=i.default},9528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e}},2193:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encoding=void 0;const i=n(1635).__importDefault(n(9528));t.encoding=i.default},7029:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);t.default=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){return e&&e.location&&0!==e.location.search.length&&0!==t.length?new URLSearchParams(e.location.search).getAll(t).filter((e=>"0"!==e)):[]}))}},4334:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=t.fetcher=void 0;const i=n(1635),o=i.__importDefault(n(7029));t.fetcher=o.default;const r=i.__importDefault(n(3091));t.structure=r.default},3091:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={};for(const[n,i]of new URLSearchParams(e).entries())t[n]=i;return t}},4774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const i=n(1635).__importDefault(n(955));t.structure=i.default},955:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.split(";").map((e=>e.trim().split("="))),n={};for(const[e,i]of t)n[decodeURIComponent(e)]=decodeURIComponent(i);return n}},5063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6590);t.default=(0,i.fetcher)("sessionStorage")},6944:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(5063));t.fetcher=i.default},1669:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);t.default=function(e){return function(t,n){return i.__awaiter(this,void 0,void 0,(function*(){if(!t||0===n.length)return[];try{const i=("localStorage"===e?t.localStorage:t.sessionStorage).getItem(n);return i&&"0"!==i?[i]:[]}catch(e){return[]}}))}}},6590:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(1669));t.fetcher=i.default},164:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const i=n(1635).__importDefault(n(8805));t.structure=i.default},8805:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{value:e}}},1031:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635),o=n(7007),r=n(8509),s=n(7111),a=n(2302),c=n(3841),u=n(3861),d=n(6944),l=n(4334),p=n(9694),f=n(164),_=n(659),h=n(7510),g=n(4334),E=n(4774),v=n(5962),y=n(2193),b=i.__importDefault(n(9207)),C=(0,n(5305).getLogger)("trait");t.default=class{constructor(e,t={}){this._emitter=new o.EventEmitter,this._w=e,this._listenerOptions=t,this._fetchers=new Map,this._attributes={}}add(e,t){let n,i;if("function"==typeof t)return void this._fetchers.set(e,(()=>t()));switch(t.format){case r.TraitFormat.TRAIT_FORMAT_JSON:n=_.structure;break;case r.TraitFormat.TRAIT_FORMAT_JWT:n=h.structure;break;case r.TraitFormat.TRAIT_FORMAT_QUERY:n=g.structure;break;case r.TraitFormat.TRAIT_FORMAT_SEMICOLON:n=E.structure;break;default:n=f.structure}const o=t.key||"value";i=t.encoding===r.TraitEncoding.TRAIT_ENCODING_BASE64?v.encoding:y.encoding;const b=(e,t)=>t.split(".").reduce(((e,t)=>e&&"object"==typeof e&&t in e?e[t]:void 0),e);switch(t.type){case r.TraitType.TRAIT_TYPE_COOKIE:this._fetchers.set(e,(e=>(0,s.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_DATA_LAYER:this._fetchers.set(e,(e=>(0,a.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_WINDOW:this._fetchers.set(e,(e=>(0,c.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_LOCAL_STORAGE:this._fetchers.set(e,(e=>(0,u.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_SESSION_STORAGE:this._fetchers.set(e,(e=>(0,d.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_QUERY_STRING:this._fetchers.set(e,(e=>(0,l.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;case r.TraitType.TRAIT_TYPE_MANAGED:this._fetchers.set(e,(e=>(0,p.fetcher)(e,t.variable).then((e=>i(e).map(n).map((e=>String(b(e,o))))))));break;default:throw new Error(`unsupported trait type ${t.type} for ${e}`)}}start(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(!this._intervalId)return this._listenerOptions.interval&&(this._intervalId=this._w.setInterval(this.notify.bind(this),this._listenerOptions.interval),this._listenerOptions.timeout&&this._w.setTimeout(this.stop.bind(this),this._listenerOptions.timeout)),this.notify(e,t)}))}stop(){this._intervalId&&(this._w.clearInterval(this._intervalId),this._intervalId=void 0)}notify(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n={};for(const[e,t]of this._fetchers.entries())try{const i=yield t(this._w);for(const t of i)n[e]=t}catch(t){C.warn(`failed to fetch trait for ${e}: ${t}`)}if(!(0,b.default)(n,this._attributes)||t&&0===Object.keys(this._attributes).length){const t=e||r.TraitName.IDENTITY;this._emitter.emit(t,n),this._attributes=n}}))}addListener(e,t){return this.on(e,t)}on(e,t){return this._emitter.on(e,t),this}once(e,t){return this._emitter.once(e,t),this}removeListener(e,t){return this.off(e,t)}off(e,t){return this._emitter.off(e,t),this}removeAllListeners(e){return this._emitter.removeAllListeners(e),this}}},2706:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);t.default=function(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];try{const n=function(e,t){const n=t.split(".");let i=e,o=null;for(;n.length>0;)if("window"===n[0])n.shift();else if("object"==typeof i)"()"===n[0].slice(-2)?(o=i,i=i[n[0].slice(0,-2)]):(o=i,i=i[n.shift()]);else{if("function"!=typeof i)return null;{const e=i.call(o);o=i,i=e,n.shift()}}return i&&"string"!=typeof i&&(i=i.toString(),i.startsWith("[object"))?"":i}(e,t);return n&&"0"!==n?[n]:[]}catch(e){return[]}}))}},3841:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const i=n(1635).__importDefault(n(2706));t.fetcher=i.default},5305:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getLogLevel=t.getLogger=t.wrapLogger=t.getParams=t.DEFAULT_LOG_LEVEL=void 0;const o=i(n(9343));t.DEFAULT_LOG_LEVEL="warn";const r={trace:1,debug:2,info:3,warn:4,error:5,log:6},s=()=>{};function a(e=window.location.search,t=["ketch_","swb_"]){return new o.default(e,t)}function c(e,t){const n=`[${t}]`;return{trace:(...t)=>{e.trace(n,...t)},debug:(...t)=>{e.debug(n,...t)},info:(...t)=>{e.info(n,...t)},log:(...t)=>{e.log(n,...t)},warn:(...t)=>{e.warn(n,...t)},error:(...t)=>{e.error(n,...t)}}}function u(e=a()){const n=e.get("log");if(n&&n.length){const e=n.toLowerCase();if(e&&r[e])return e}else if(e.has("debug"))return"debug";return t.DEFAULT_LOG_LEVEL}t.getParams=a,t.wrapLogger=c,t.getLogger=function(e,t=u(a())){const i={log:n.g.console.log,error:n.g.console.error};t=t.toString().toLowerCase();for(const e of Object.keys(r))i[e]="log"===e||r[e]>=r[t]?"error"===e?i.error:i.log:s;return c(i,e)},t.getLogLevel=u},9343:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends URLSearchParams{constructor(e,t){super(e),this._prefixes=t}delete(e){for(const t of this._prefixes)super.delete(`${t}${e}`)}get(e){for(const t of this._prefixes){const n=super.get(`${t}${e}`);if(n)return n}return null}getAll(e){for(const t of this._prefixes)if(super.has(`${t}${e}`))return super.getAll(`${t}${e}`);return[]}has(e){for(const t of this._prefixes)if(super.has(`${t}${e}`))return!0;return!1}}t.default=n},7586:(e,t)=>{"use strict";var n,i,o,r,s,a,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RelationalOperator=t.Operator=t.ConditionType=t.FormFieldVariant=t.FormFieldType=t.FormFieldCategory=t.FormFieldWidth=void 0,(c=t.FormFieldWidth||(t.FormFieldWidth={})).UNSPECIFIED="unspecified",c.HALF="half",c.FULL="full",(a=t.FormFieldCategory||(t.FormFieldCategory={})).UNSPECIFIED="unspecified",a.DEFAULT="default",a.CUSTOM="custom",(s=t.FormFieldType||(t.FormFieldType={})).UNSPECIFIED="unspecified",s.TEXT="text",s.DROPDOWN="dropdown",s.CHECKBOX="checkbox",s.FILE="file",(r=t.FormFieldVariant||(t.FormFieldVariant={})).UNSPECIFIED="unspecified",r.INPUT="input",r.TEXTAREA="textarea",(o=t.ConditionType||(t.ConditionType={})).CONDITION_TYPE_UNSPECIFIED="CONDITION_TYPE_UNSPECIFIED",o.CONDITION_TYPE_FORM_FIELD="CONDITION_TYPE_FORM_FIELD",o.CONDITION_TYPE_DATA_SUBJECT="CONDITION_TYPE_DATA_SUBJECT",o.UNRECOGNIZED="UNRECOGNIZED",(i=t.Operator||(t.Operator={})).OPERATOR_UNSPECIFIED="OPERATOR_UNSPECIFIED",i.OPERATOR_EQUALS="OPERATOR_EQUALS",i.OPERATOR_NOT_EQUALS="OPERATOR_NOT_EQUALS",i.OPERATOR_GREATER_THAN="OPERATOR_GREATER_THAN",i.OPERATOR_LESS_THAN="OPERATOR_LESS_THAN",i.OPERATOR_GREATER_THAN_OR_EQUALS="OPERATOR_GREATER_THAN_OR_EQUALS",i.OPERATOR_LESS_THAN_OR_EQUALS="OPERATOR_LESS_THAN_OR_EQUALS",i.OPERATOR_CONTAINS="OPERATOR_CONTAINS",i.OPERATOR_NOT_CONTAINS="OPERATOR_NOT_CONTAINS",i.OPERATOR_IN="OPERATOR_IN",i.OPERATOR_NOT_IN="OPERATOR_NOT_IN",i.OPERATOR_EMPTY="OPERATOR_EMPTY",i.OPERATOR_NOT_EMPTY="OPERATOR_NOT_EMPTY",i.UNRECOGNIZED="UNRECOGNIZED",(n=t.RelationalOperator||(t.RelationalOperator={})).RELATIONAL_OPERATOR_UNSPECIFIED="RELATIONAL_OPERATOR_UNSPECIFIED",n.RELATIONAL_OPERATOR_AND="RELATIONAL_OPERATOR_AND",n.RELATIONAL_OPERATOR_OR="RELATIONAL_OPERATOR_OR",n.UNRECOGNIZED="UNRECOGNIZED"},8509:(e,t,n)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FormFieldStyle=t.UnsubscribeFromAllPosition=t.SubscriptionChannelArrangementStyle=t.SubscriptionListStyle=t.ExitButtonPosition=t.ModalContainerPosition=t.BannerContainerPosition=t.BannerContainerSize=t.BannerContainerLayout=t.ListLayout=t.ItemStyle=t.BannerModalLogoPosition=t.ButtonVariant=t.SubscriptionStatus=t.RightSource=t.SubscriptionSource=t.ConsentSource=t.SubscriptionExperienceItemType=t.TraitName=t.DeploymentVersion=t.VendorStatus=t.StorageOriginPolicy=t.ExperienceActionKind=t.ModalPosition=t.BannerPosition=t.SubscriptionControlPositionType=t.SubscriptionControlImpactType=t.SwitchTextRenderLogic=t.TraitEncoding=t.TraitFormat=t.TraitType=t.IdentityEncoding=t.IdentityFormat=t.IdentityType=t.CookieCategory=t.CookieProvenance=t.CookieDuration=t.MigrationOption=t.ExperiencePrimaryButtonAction=t.ExperienceButtonDestination=t.ExperienceDefault=t.SetConsentReason=t.ExperienceClosedReason=t.ConsentExperienceType=t.ExperienceDisplayType=t.DisplayConsentExperienceType=t.DisplayExperienceType=t.ExperienceType=t.isTab=t.Tab=void 0,t.FormFieldVariant=t.FormFieldType=t.FormFieldCategory=t.FormFieldWidth=t.PreviewMessageType=t.BannerAutoDismissOverride=t.BannerDismissAnimation=t.RuleTrigger=t.ActionFunction=t.ConditionOperator=t.OperatorType=t.DeploymentExperienceType=t.ExperienceLoadingMethod=t.RequirementsNotMatchedState=t.ProgressiveExperienceButtonAction=t.ProgressiveExperiencePosition=t.ProgressiveExperienceConsentLayout=t.ProgressiveExperienceType=t.RightsFormMode=t.CanonicalRightCode=t.SubscriptionItemType=t.UnsubscribeAllImpact=t.PreferenceCenterPage=t.QuickLinkAction=t.BannerButtonAction=t.PurposeStacksMode=t.ExperienceLinkType=t.SwitchButtonDisplay=void 0,function(e){e.Overview="overviewTab",e.Rights="rightsTab",e.Consents="consentsTab",e.Subscriptions="subscriptionsTab",e.Profile="profileTab"}(i=t.Tab||(t.Tab={}));const o=Object.values(i).map((e=>e.toString()));var r,s,a,c,u,d,l,p,f,_,h,g,E,v,y,b,C,T,m,O,w,N,S,I,A,P,R,L,x,D,k,j,M,U,F,B,V,H,G,Y,W,K,$,X,z,J,q,Q,Z,ee,te,ne,ie,oe,re,se,ae,ce,ue,de,le,pe,fe,_e,he,ge,Ee,ve,ye,be;t.isTab=function(e){return o.includes(e)},(be=t.ExperienceType||(t.ExperienceType={})).Consent="experiences.consent",be.Preference="experiences.preference",be.ConsentGate="experiences.consentGate",(ye=t.DisplayExperienceType||(t.DisplayExperienceType={})).Banner="banner",ye.Modal="modal",ye.Preference="preference",ye.ConsentGate="consentGate",(ve=t.DisplayConsentExperienceType||(t.DisplayConsentExperienceType={})).Banner="banner",ve.Modal="modal",(Ee=t.ExperienceDisplayType||(t.ExperienceDisplayType={})).Banner="experiencedisplays.banner",Ee.Modal="experiencedisplays.modal",Ee.Preference="experiencedisplays.preference",Ee.ConsentGate="experiencedisplays.consentGate",(ge=t.ConsentExperienceType||(t.ConsentExperienceType={})).Banner="experiences.consent.banner",ge.Modal="experiences.consent.modal",ge.JIT="experiences.consent.jit",(he=t.ExperienceClosedReason||(t.ExperienceClosedReason={})).SET_CONSENT="setConsent",he.INVOKE_RIGHT="invokeRight",he.CLOSE="close",he.CLOSE_WITHOUT_SETTING_CONSENT="closeWithoutSettingConsent",he.WILL_NOT_SHOW="willNotShow",he.SET_SUBSCRIPTIONS="setSubscriptions",(_e=t.SetConsentReason||(t.SetConsentReason={})).USER_UPDATE="userUpdate",_e.USER_EXPERIENCE_DISMISSAL="userExperienceDismissal",_e.DEFAULT_STATE="defaultState",(fe=t.ExperienceDefault||(t.ExperienceDefault={}))[fe.BANNER=1]="BANNER",fe[fe.MODAL=2]="MODAL",(pe=t.ExperienceButtonDestination||(t.ExperienceButtonDestination={}))[pe.GOTO_MODAL=1]="GOTO_MODAL",pe[pe.GOTO_PREFERENCE=2]="GOTO_PREFERENCE",pe[pe.REJECT_ALL=3]="REJECT_ALL",(le=t.ExperiencePrimaryButtonAction||(t.ExperiencePrimaryButtonAction={}))[le.SAVE_CURRENT_STATE=1]="SAVE_CURRENT_STATE",le[le.ACCEPT_ALL=2]="ACCEPT_ALL",(de=t.MigrationOption||(t.MigrationOption={}))[de.MIGRATE_DEFAULT=0]="MIGRATE_DEFAULT",de[de.MIGRATE_NEVER=1]="MIGRATE_NEVER",de[de.MIGRATE_FROM_ALLOW=2]="MIGRATE_FROM_ALLOW",de[de.MIGRATE_FROM_DENY=3]="MIGRATE_FROM_DENY",de[de.MIGRATE_ALWAYS=4]="MIGRATE_ALWAYS",(ue=t.CookieDuration||(t.CookieDuration={}))[ue.SESSION=1]="SESSION",ue[ue.PERSISTENT=2]="PERSISTENT",(ce=t.CookieProvenance||(t.CookieProvenance={}))[ce.FIRST_PARTY=1]="FIRST_PARTY",ce[ce.THIRD_PARTY=2]="THIRD_PARTY",(ae=t.CookieCategory||(t.CookieCategory={}))[ae.STRICTLY_NECESSARY=1]="STRICTLY_NECESSARY",ae[ae.FUNCTIONAL=2]="FUNCTIONAL",ae[ae.PERFORMANCE=3]="PERFORMANCE",ae[ae.MARKETING=4]="MARKETING",(se=t.IdentityType||(t.IdentityType={})).IDENTITY_TYPE_UNDEFINED="",se.IDENTITY_TYPE_DATA_LAYER="dataLayer",se.IDENTITY_TYPE_WINDOW="window",se.IDENTITY_TYPE_COOKIE="cookie",se.IDENTITY_TYPE_MANAGED="managedCookie",se.IDENTITY_TYPE_LOCAL_STORAGE="localStorage",se.IDENTITY_TYPE_SESSION_STORAGE="sessionStorage",se.IDENTITY_TYPE_QUERY_STRING="queryString",(re=t.IdentityFormat||(t.IdentityFormat={})).IDENTITY_FORMAT_UNDEFINED="",re.IDENTITY_FORMAT_STRING="string",re.IDENTITY_FORMAT_JSON="json",re.IDENTITY_FORMAT_JWT="jwt",re.IDENTITY_FORMAT_QUERY="query",re.IDENTITY_FORMAT_SEMICOLON="semicolon",(oe=t.IdentityEncoding||(t.IdentityEncoding={})).IDENTITY_ENCODING_UNDEFINED="",oe.IDENTITY_ENCODING_NONE="none",oe.IDENTITY_ENCODING_BASE64="base64",(ie=t.TraitType||(t.TraitType={})).TRAIT_TYPE_UNDEFINED="",ie.TRAIT_TYPE_DATA_LAYER="dataLayer",ie.TRAIT_TYPE_WINDOW="window",ie.TRAIT_TYPE_COOKIE="cookie",ie.TRAIT_TYPE_MANAGED="managedCookie",ie.TRAIT_TYPE_LOCAL_STORAGE="localStorage",ie.TRAIT_TYPE_SESSION_STORAGE="sessionStorage",ie.TRAIT_TYPE_QUERY_STRING="queryString",(ne=t.TraitFormat||(t.TraitFormat={})).TRAIT_FORMAT_UNDEFINED="",ne.TRAIT_FORMAT_STRING="string",ne.TRAIT_FORMAT_JSON="json",ne.TRAIT_FORMAT_JWT="jwt",ne.TRAIT_FORMAT_QUERY="query",ne.TRAIT_FORMAT_SEMICOLON="semicolon",(te=t.TraitEncoding||(t.TraitEncoding={})).TRAIT_ENCODING_UNDEFINED="",te.TRAIT_ENCODING_NONE="none",te.TRAIT_ENCODING_BASE64="base64",(ee=t.SwitchTextRenderLogic||(t.SwitchTextRenderLogic={}))[ee.SWITCH_TEXT_RENDER_ALL=1]="SWITCH_TEXT_RENDER_ALL",ee[ee.SWITCH_TEXT_RENDER_LEGAL_BASIS=2]="SWITCH_TEXT_RENDER_LEGAL_BASIS",ee[ee.SWITCH_TEXT_RENDER_CHANGE=3]="SWITCH_TEXT_RENDER_CHANGE",ee[ee.SWITCH_TEXT_RENDER_NEVER=4]="SWITCH_TEXT_RENDER_NEVER",(Z=t.SubscriptionControlImpactType||(t.SubscriptionControlImpactType={}))[Z.UNSPECIFIED=0]="UNSPECIFIED",Z[Z.GLOBAL=1]="GLOBAL",Z[Z.LOCAL=2]="LOCAL",(Q=t.SubscriptionControlPositionType||(t.SubscriptionControlPositionType={}))[Q.UNSPECIFIED=0]="UNSPECIFIED",Q[Q.TOP=1]="TOP",Q[Q.BOTTOM=2]="BOTTOM",(q=t.BannerPosition||(t.BannerPosition={}))[q.BOTTOM=1]="BOTTOM",q[q.TOP=2]="TOP",q[q.BOTTOM_LEFT=3]="BOTTOM_LEFT",q[q.BOTTOM_RIGHT=4]="BOTTOM_RIGHT",(J=t.ModalPosition||(t.ModalPosition={}))[J.CENTER=1]="CENTER",J[J.LEFT_FULL_HEIGHT=2]="LEFT_FULL_HEIGHT",J[J.RIGHT_FULL_HEIGHT=3]="RIGHT_FULL_HEIGHT",(z=t.ExperienceActionKind||(t.ExperienceActionKind={}))[z.ShowExperience=0]="ShowExperience",z[z.HideExperience=1]="HideExperience",z[z.SetConsent=2]="SetConsent",z[z.SetSubscription=3]="SetSubscription",z[z.InvokeRight=4]="InvokeRight",(X=t.StorageOriginPolicy||(t.StorageOriginPolicy={})).CrossOrigin="cross-origin",X.SameOrigin="same-origin,",($=t.VendorStatus||(t.VendorStatus={})).Granted="granted",$.Denied="denied",(K=t.DeploymentVersion||(t.DeploymentVersion={})).V1="v1",K.V2="v2",(W=t.TraitName||(t.TraitName={})).IDENTITY="identity",W.USER_ATTRIBUTE="userAttribute",(Y=t.SubscriptionExperienceItemType||(t.SubscriptionExperienceItemType={}))[Y.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_UNKNOWN=0]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_UNKNOWN",Y[Y.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_TOPIC=1]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_TOPIC",Y[Y.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_CONTROL=2]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_CONTROL",(G=t.ConsentSource||(t.ConsentSource={})).LegalBasisDefault="legalBasisDefault",G.GpcPlugins="plugins.gpc",G.OneTrustMigrator="plugins.onetrust",G.BannerSaveCurrentState="banner.saveCurrentState",G.BannerAcceptAll="banner.acceptAll",G.BannerRejectAll="banner.rejectAll",G.BannerCloseButton="banner.closeButton",G.BannerAutoDismiss="banner.autoDismiss",G.BannerAutoDismissLegalBasis="banner.autoDismissLegalBasis",G.BannerAutoDismissTrue="banner.autoDismissTrue",G.BannerAutoDismissFalse="banner.autoDismissFalse",G.BannerAutoDismissNone="banner.autoDismissNone",G.ModalAcceptAll="modal.acceptAll",G.ModalRejectAll="modal.rejectAll",G.ModalDefault="modal.default",G.ModalManual="modal.manual",G.ModalCloseButton="modal.closeButton",G.PreferenceConsentsTabAcceptAll="preference.consentsTab.acceptAll",G.PreferenceConsentsTabRejectAll="preference.consentsTab.rejectAll",G.PreferenceDefault="preference.default",G.PreferenceManual="preference.manual",G.RouterSetConsent="router.setConsent",G.ProgressiveConsent="progressive.consent",G.ConsentGate="consentGate",G.WorkflowSetPermits="workflow.setPermits",G.PushedFromID="id.pushedFromId",G.PushedToID="id.resolved",G.LateArrivingID="id.lateArriving",G.Headless="headless",G.AuditLogAcceptAll="auditLog.acceptAll",G.AuditLogRejectAll="auditLog.rejectAll",G.AuditLogDefault="auditLog.default",G.AuditLogManual="auditLog.manual",G.RouterAcceptAllConsent="router.acceptAllConsent",G.RouterRejectAllConsent="router.rejectAllConsent",G.Unknown="unknown",(H=t.SubscriptionSource||(t.SubscriptionSource={})).PreferenceSubscriptionsTabManual="preference.subscriptionsTab.manual",H.PreferenceSubscriptionsTabUnsubscribeAll="preference.subscriptionsTab.unsubscribeAll",H.ProgressiveSubscription="progressive.subscription",H.ConsentGateSubscription="consentGate.subscription",H.RouterSetSubscriptions="router.setSubscriptions",H.AuditLogSubscribeAll="auditLog.subscribeAll",H.AuditLogUnsubscribeAll="auditLog.unsubscribeAll",H.AuditLogDefault="auditLog.default",H.AuditLogManual="auditLog.manual",H.Headless="headless",H.Unknown="unknown",(V=t.RightSource||(t.RightSource={})).PreferenceRightsTabInvoke="preference.rightsTab.invoke",V.Headless="headless",(B=t.SubscriptionStatus||(t.SubscriptionStatus={})).Denied="denied",B.Granted="granted",(F=t.ButtonVariant||(t.ButtonVariant={})).Outlined="outlined",F.Contained="contained",(U=t.BannerModalLogoPosition||(t.BannerModalLogoPosition={})).Top="top",U.Left="left",(M=t.ItemStyle||(t.ItemStyle={})).Filled="filled",M.Outlined="outlined",(j=t.ListLayout||(t.ListLayout={})).Expandable="expandable",j.Cards="cards",(k=t.BannerContainerLayout||(t.BannerContainerLayout={})).Horizontal="horizontal",k.Vertical="vertical",k.Centered="centered",(D=t.BannerContainerSize||(t.BannerContainerSize={})).Standard="standard",D.Compact="compact",(x=t.BannerContainerPosition||(t.BannerContainerPosition={})).Bottom="bottom",x.Top="top",x.LeftCorner="leftCorner",x.RightCorner="rightCorner",x.BottomMiddle="bottomMiddle",x.Center="center",(L=t.ModalContainerPosition||(t.ModalContainerPosition={})).Center="center",L.Left="left",L.Right="right",(R=t.ExitButtonPosition||(t.ExitButtonPosition={})).topRight="topRight",R.bottomLeft="bottomLeft",(P=t.SubscriptionListStyle||(t.SubscriptionListStyle={})).Filled="filled",P.Underlined="underlined",(A=t.SubscriptionChannelArrangementStyle||(t.SubscriptionChannelArrangementStyle={})).Horizontal="horizontal",A.Vertical="vertical",(I=t.UnsubscribeFromAllPosition||(t.UnsubscribeFromAllPosition={})).Top="top",I.Bottom="bottom",(S=t.FormFieldStyle||(t.FormFieldStyle={})).Box="box",S.Underline="underline",(N=t.SwitchButtonDisplay||(t.SwitchButtonDisplay={})).Always="always",N.WhenLegalBasisDiffers="whenLegalBasisDiffers",(t.ExperienceLinkType||(t.ExperienceLinkType={})).Vendor="vendor",(w=t.PurposeStacksMode||(t.PurposeStacksMode={})).AlwaysOpen="alwaysOpen",w.AlwaysClosed="alwaysClosed",w.DefaultOpen="defaultOpen",w.DefaultClosed="defaultClosed",(O=t.BannerButtonAction||(t.BannerButtonAction={})).SaveCurrentState="saveCurrentState",O.AcceptAll="acceptAll",O.OpenModal="openModal",O.OpenPreferences="openPreferences",O.RejectAll="rejectAll",O.OpenURL="openURL",(m=t.QuickLinkAction||(t.QuickLinkAction={})).OpenUrl="openUrl",m.OpenPage="openPage",(T=t.PreferenceCenterPage||(t.PreferenceCenterPage={})).Welcome="welcome",T.PrivacyPolicy="privacyPolicy",T.Purpose="purpose",T.Subscriptions="subscriptions",T.RequestsHome="requestsHome",T.RequestsForm="requestsForm",T.RequestsSubmitted="requestsSubmitted",(C=t.UnsubscribeAllImpact||(t.UnsubscribeAllImpact={})).Universal="universal",C.SingleExperience="singleExperience",(b=t.SubscriptionItemType||(t.SubscriptionItemType={})).Unknown="unknown",b.Topic="topic",b.Control="control",(y=t.CanonicalRightCode||(t.CanonicalRightCode={})).Get="get",y.Delete="delete",y.Restrict="restrict",y.Update="update",(v=t.RightsFormMode||(t.RightsFormMode={})).Single="single",v.Custom="custom",(E=t.ProgressiveExperienceType||(t.ProgressiveExperienceType={})).Consent="consent",E.Subscription="subscription",(g=t.ProgressiveExperienceConsentLayout||(t.ProgressiveExperienceConsentLayout={})).ActionButtons="actionButtons",g.ToggleSwitch="toggleSwitch",(h=t.ProgressiveExperiencePosition||(t.ProgressiveExperiencePosition={})).FollowPointer="followPointer",h.Embed="embed",(_=t.ProgressiveExperienceButtonAction||(t.ProgressiveExperienceButtonAction={})).Accept="accept",_.Reject="reject",_.Dismiss="dismiss",(f=t.RequirementsNotMatchedState||(t.RequirementsNotMatchedState={})).Alert="alert",f.Redirect="redirect",(p=t.ExperienceLoadingMethod||(t.ExperienceLoadingMethod={})).Initial="initial",p.Dynamic="dynamic",(l=t.DeploymentExperienceType||(t.DeploymentExperienceType={})).AutoInitiated="autoInitiated",l.UserInitiated="userInitiated",(d=t.OperatorType||(t.OperatorType={})).EQUALS="EQ",d.NOT_EQUALS="NEQ",d.GREATER_THAN="GT",d.LESS_THAN="LT",d.GREATER_THAN_OR_EQUAL="GTE",d.LESS_THAN_OR_EQUAL="LTE",d.CONTAINS="CN",d.REGEX_MATCH_FIND="MCH",d.EXISTS="EX",d.NOT_EXISTS="NEX",d.IN="IN",d.UNKNOWN="",(u=t.ConditionOperator||(t.ConditionOperator={})).AND="AND",u.OR="OR",u.NOT="NOT",(t.ActionFunction||(t.ActionFunction={})).SHOW_EXPERIENCE="showExperience",(c=t.RuleTrigger||(t.RuleTrigger={})).ON_LOAD="onPageLoad",c.ON_FUNCTION="onFunction",(a=t.BannerDismissAnimation||(t.BannerDismissAnimation={})).FADE="fade",a.LOWER="lower",(s=t.BannerAutoDismissOverride||(t.BannerAutoDismissOverride={})).NOTHING="none",s.LEGAL_BASIS="legalBasis",s.TRUE="true",s.FALSE="false",(r=t.PreviewMessageType||(t.PreviewMessageType={})).LoadConfig="loadConfig",r.ShowBanner="showBanner",r.ShowModal="showModal",r.ShowPreference="showPreferences",r.SwitchPreferencePage="switchPreferencePage",r.ShowConsentGate="showConsentGate";var Ce=n(7586);Object.defineProperty(t,"FormFieldWidth",{enumerable:!0,get:function(){return Ce.FormFieldWidth}}),Object.defineProperty(t,"FormFieldCategory",{enumerable:!0,get:function(){return Ce.FormFieldCategory}}),Object.defineProperty(t,"FormFieldType",{enumerable:!0,get:function(){return Ce.FormFieldType}}),Object.defineProperty(t,"FormFieldVariant",{enumerable:!0,get:function(){return Ce.FormFieldVariant}})},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>k,__assign:()=>r,__asyncDelegator:()=>w,__asyncGenerator:()=>O,__asyncValues:()=>N,__await:()=>m,__awaiter:()=>_,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>D,__classPrivateFieldSet:()=>x,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>M,__esDecorate:()=>u,__exportStar:()=>E,__extends:()=>o,__generator:()=>h,__importDefault:()=>R,__importStar:()=>P,__makeTemplateObject:()=>S,__metadata:()=>f,__param:()=>c,__propKey:()=>l,__read:()=>y,__rest:()=>s,__rewriteRelativeImportExtension:()=>U,__runInitializers:()=>d,__setFunctionName:()=>p,__spread:()=>b,__spreadArray:()=>T,__spreadArrays:()=>C,__values:()=>v,default:()=>F});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function a(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,i){t(n,i,e)}}function u(e,t,n,i,o,r){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=i.kind,u="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,l=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),p=!1,f=n.length-1;f>=0;f--){var _={};for(var h in i)_[h]="access"===h?{}:i[h];for(var h in i.access)_.access[h]=i.access[h];_.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");r.push(s(e||null))};var g=(0,n[f])("accessor"===c?{get:l.get,set:l.set}:l[u],_);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=s(g.get))&&(l.get=a),(a=s(g.set))&&(l.set=a),(a=s(g.init))&&o.unshift(a)}else(a=s(g))&&("field"===c?o.unshift(a):l[u]=a)}d&&Object.defineProperty(d,i.name,l),p=!0}function d(e,t,n){for(var i=arguments.length>2,o=0;o<t.length;o++)n=i?t[o].call(e,n):t[o].call(e);return i?n:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function _(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function h(e,t){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function E(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i}function T(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function O(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n.apply(e,t||[]),r=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),i[Symbol.asyncIterator]=function(){return this},i;function s(e,t){o[e]&&(i[e]=function(t){return new Promise((function(n,i){r.push([e,t,n,i])>1||a(e,t)}))},t&&(i[e]=t(i[e])))}function a(e,t){try{(n=o[e](t)).value instanceof m?Promise.resolve(n.value.v).then(c,u):d(r[0][2],n)}catch(e){d(r[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function d(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function w(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,o){t[i]=e[i]?function(t){return(n=!n)?{value:m(e[i](t)),done:!1}:o?o(t):t}:o}}function N(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,o,(t=e[n](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},A=function(e){return A=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},A(e)};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=A(e),i=0;i<n.length;i++)"default"!==n[i]&&g(t,e,n[i]);return I(t,e),t}function R(e){return e&&e.__esModule?e:{default:e}}function L(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function x(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function k(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i,o;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],n&&(o=i)}if("function"!=typeof i)throw new TypeError("Object not disposable.");o&&(i=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:n})}else n&&e.stack.push({async:!0});return t}var j="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function M(e){function t(t){e.error=e.hasError?new j(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,i=0;return function o(){for(;n=e.stack.pop();)try{if(!n.async&&1===i)return i=0,e.stack.push(n),Promise.resolve().then(o);if(n.dispose){var r=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(r).then(o,(function(e){return t(e),o()}))}else i|=1}catch(e){t(e)}if(1===i)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function U(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,n,i,o,r){return n?t?".jsx":".js":!i||o&&r?i+o+"."+r.toLowerCase()+"js":e})):e}const F={__extends:o,__assign:r,__rest:s,__decorate:a,__param:c,__esDecorate:u,__runInitializers:d,__propKey:l,__setFunctionName:p,__metadata:f,__awaiter:_,__generator:h,__createBinding:g,__exportStar:E,__values:v,__read:y,__spread:b,__spreadArrays:C,__spreadArray:T,__await:m,__asyncGenerator:O,__asyncDelegator:w,__asyncValues:N,__makeTemplateObject:S,__importStar:P,__importDefault:R,__classPrivateFieldGet:L,__classPrivateFieldSet:x,__classPrivateFieldIn:D,__addDisposableResource:k,__disposeResources:M,__rewriteRelativeImportExtension:U}},8163:e=>{"use strict";e.exports={version:"0.0.0"}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=n(1635),t=n(549),i=e.__importDefault(n(5307));window.semaphore=window.semaphore||[],window.semaphore.push(["registerPlugin",i.default]),(0,t.boot)()})()})();